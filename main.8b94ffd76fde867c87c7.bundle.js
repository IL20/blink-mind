(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1150:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var renderer_react_1=__webpack_require__(79),rich_text_editor_1=__webpack_require__(442),core_1=__webpack_require__(31),TopicDescEditor=function(_super){function TopicDescEditor(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getCustomizeProps=function(){var _a=_this.props,model=_a.model,topicKey=_a.topicKey;return{block:model.getTopic(topicKey).getBlock(core_1.BlockType.DESC).block,readOnly:model.editingDescKey!==topicKey,refKeyPrefix:"desc-editor"}},_this.onChange=function(value){_this.operation(renderer_react_1.OpType.SET_TOPIC_DESC,__assign(__assign({},_this.props),{desc:value}))},_this}return __extends(TopicDescEditor,_super),TopicDescEditor}(rich_text_editor_1.RichTextEditor);exports.TopicDescEditor=TopicDescEditor},1151:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var slate_md_serializer_1=__webpack_require__(447);exports.default=new slate_md_serializer_1.default},1152:function(module,exports,__webpack_require__){"use strict";(function(module){var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,templateObject_3,templateObject_4,templateObject_5,withSourceLoader=__webpack_require__(132).withSource,__STORY__="import * as React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { BaseDemo } from '../common/base-demo';\nimport { Diagram, iconClassName, Icon } from '@blink-mind/renderer-react';\nimport { ThemeSelectorPlugin } from '@blink-mind/plugin-theme-selector';\nimport { Popover, Menu, MenuItem } from '@blueprintjs/core';\nimport styled from 'styled-components';\nimport { DiagramLayoutType } from '@blink-mind/core';\n\nconst ToolBar = styled.div`\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n`;\n\nconst ToolBarItem = styled.div`\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n  display: inline-block;\n`;\n\nconst ToolBarIcon = styled.div`\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n  &:hover {\n    color: #106ba3;\n  }\n`;\n\nconst Container = styled.div`\n  width: 100%;\n  height: 100%;\n`;\n\nconst DiagramContainer = styled.div`\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n`;\n\nconst plugins = [ThemeSelectorPlugin()];\nclass ThemeSelectorDemo extends BaseDemo {\n  themeIndex = 1;\n  onClickChangeTheme = () => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    let themeKeys = controller.run('getAllThemes', props).keys();\n    themeKeys = Array.from(themeKeys);\n    controller.run('setTheme', {\n      ...props,\n      themeKey: themeKeys[this.themeIndex++ % themeKeys.length]\n    });\n  };\n  onClickSetLayout = layoutDir => e => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run('setLayoutDir', {\n      ...props,\n      layoutDir\n    });\n  };\n  renderToolbar() {\n    const layoutDirs = [\n      [\n        DiagramLayoutType.LEFT_AND_RIGHT,\n        'Left And Right',\n        'layout-left-and-right'\n      ],\n      [DiagramLayoutType.LEFT_TO_RIGHT, 'Only Right', 'layout-right'],\n      [DiagramLayoutType.RIGHT_TO_LEFT, 'Only Left', 'layout-left']\n    ];\n    return (\n      <ToolBar>\n        <ToolBarItem onClick={this.onClickChangeTheme}>\n          <ToolBarIcon className={iconClassName('theme')} />\n        </ToolBarItem>\n        <ToolBarItem>\n          <Popover enforceFocus={false}>\n            <ToolBarIcon className={iconClassName('layout-left-and-right')} />\n            <Menu>\n              {layoutDirs.map(dir => (\n                <MenuItem\n                  key={dir[1]}\n                  icon={Icon(dir[2])}\n                  text={dir[1]}\n                  onClick={this.onClickSetLayout(dir[0])}\n                />\n              ))}\n            </Menu>\n          </Popover>\n        </ToolBarItem>\n      </ToolBar>\n    );\n  }\n  diagram: Diagram;\n  diagramRef = e => {\n    this.diagram = e;\n  };\n  renderDiagram() {\n    return (\n      <Container>\n        {this.renderToolbar()}\n        <DiagramContainer>\n          <Diagram\n            model={this.state.model}\n            onChange={this.onChange}\n            plugins={plugins}\n            ref={this.diagramRef}\n          />\n        </DiagramContainer>\n      </Container>\n    );\n  }\n}\n\nstoriesOf('theme-selector-demo', module).add(\n  'theme-selector',\n  () => <ThemeSelectorDemo />,\n  {}\n);\n",__ADDS_MAP__={"theme-selector-demo--theme-selector":{startLoc:{col:2,line:119},endLoc:{col:4,line:121},startBody:{col:2,line:120},endBody:{col:29,line:120}}},React=__webpack_require__(0),react_1=__webpack_require__(80),base_demo_1=__webpack_require__(134),renderer_react_1=__webpack_require__(79),plugin_theme_selector_1=__webpack_require__(1153),core_1=__webpack_require__(51),styled_components_1=__webpack_require__(14),core_2=__webpack_require__(31),ToolBar=styled_components_1.default.div.withConfig({displayName:"ToolBar",componentId:"sc-ibs0o7"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n"],["\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n"]))),ToolBarItem=styled_components_1.default.div.withConfig({displayName:"ToolBarItem",componentId:"sc-haqcxg"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n  display: inline-block;\n"],["\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n  display: inline-block;\n"]))),ToolBarIcon=styled_components_1.default.div.withConfig({displayName:"ToolBarIcon",componentId:"sc-1fylgsn"})(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n  &:hover {\n    color: #106ba3;\n  }\n"],["\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n  &:hover {\n    color: #106ba3;\n  }\n"]))),Container=styled_components_1.default.div.withConfig({displayName:"Container",componentId:"sc-138fea4"})(templateObject_4||(templateObject_4=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n"],["\n  width: 100%;\n  height: 100%;\n"]))),DiagramContainer=styled_components_1.default.div.withConfig({displayName:"DiagramContainer",componentId:"sc-skrzor"})(templateObject_5||(templateObject_5=__makeTemplateObject(["\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n"],["\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n"]))),plugins=[plugin_theme_selector_1.ThemeSelectorPlugin()],ThemeSelectorDemo=function(_super){function ThemeSelectorDemo(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.themeIndex=1,_this.onClickChangeTheme=function(){var props=_this.diagram.getDiagramProps(),controller=props.controller,themeKeys=controller.run("getAllThemes",props).keys();themeKeys=Array.from(themeKeys),controller.run("setTheme",__assign(__assign({},props),{themeKey:themeKeys[_this.themeIndex++%themeKeys.length]}))},_this.onClickSetLayout=function(layoutDir){return function(e){var props=_this.diagram.getDiagramProps();props.controller.run("setLayoutDir",__assign(__assign({},props),{layoutDir:layoutDir}))}},_this.diagramRef=function(e){_this.diagram=e},_this}return __extends(ThemeSelectorDemo,_super),ThemeSelectorDemo.prototype.renderToolbar=function(){var _this=this,layoutDirs=[[core_2.DiagramLayoutType.LEFT_AND_RIGHT,"Left And Right","layout-left-and-right"],[core_2.DiagramLayoutType.LEFT_TO_RIGHT,"Only Right","layout-right"],[core_2.DiagramLayoutType.RIGHT_TO_LEFT,"Only Left","layout-left"]];return React.createElement(ToolBar,null,React.createElement(ToolBarItem,{onClick:this.onClickChangeTheme},React.createElement(ToolBarIcon,{className:renderer_react_1.iconClassName("theme")})),React.createElement(ToolBarItem,null,React.createElement(core_1.Popover,{enforceFocus:!1},React.createElement(ToolBarIcon,{className:renderer_react_1.iconClassName("layout-left-and-right")}),React.createElement(core_1.Menu,null,layoutDirs.map((function(dir){return React.createElement(core_1.MenuItem,{key:dir[1],icon:renderer_react_1.Icon(dir[2]),text:dir[1],onClick:_this.onClickSetLayout(dir[0])})}))))))},ThemeSelectorDemo.prototype.renderDiagram=function(){return React.createElement(Container,null,this.renderToolbar(),React.createElement(DiagramContainer,null,React.createElement(renderer_react_1.Diagram,{model:this.state.model,onChange:this.onChange,plugins:plugins,ref:this.diagramRef})))},ThemeSelectorDemo}(base_demo_1.BaseDemo);react_1.storiesOf("theme-selector-demo",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/index.stories.tsx",[],{},"/home/zhou/coding/awehook/blink-mind/stories/theme-selector-demo",{})).add("theme-selector",(function(){return React.createElement(ThemeSelectorDemo,null)}),{})}).call(this,__webpack_require__(67)(module))},1153:function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(1154)),__export(__webpack_require__(158))},1154:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core_1=__webpack_require__(31),themes_1=__webpack_require__(158),themes_2=__webpack_require__(158),themes_3=__webpack_require__(158),themes_4=__webpack_require__(158);exports.ThemeSelectorPlugin=function ThemeSelectorPlugin(){var themeMap=new Map([["default",core_1.defaultTheme],["theme1",themes_1.theme1],["theme2",themes_2.theme2],["theme3",themes_3.theme3],["theme4",themes_4.theme4]]);return{getAllThemes:function(props){return themeMap},setTheme:function(props){var model=props.model,controller=props.controller,themeKey=props.themeKey;themeKey;var allTheme=controller.run("getAllThemes",props);if(!allTheme.has(themeKey))throw new Error("setTheme: the theme key is not correct!");var theme=allTheme.get(themeKey),newModel=core_1.ModelModifier.setTheme({model:model,theme:theme});controller.change(newModel)}}}},1155:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.theme1={name:"theme1",randomColor:!1,background:"rgb(250,245,205)",highlightColor:"#50C9CE",marginH:50,marginV:30,fontFamily:"",bold:!1,italic:!1,textAlign:"left",rootTopic:{background:"rgb(221, 170, 68)",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},primaryTopic:{background:"#e8eaec",borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(221, 170, 68)",borderRadius:"5px",color:"#ffffff",fontSize:"17px",padding:"10px 15px 10px 15px",linkStyle:{lineType:"curve",lineWidth:2,lineColor:"rgb(187, 136, 34)"}},normalTopic:{background:"#fff",border:"1px solid #e8eaec",borderRadius:"20px",color:"rgb(187, 136, 34)",fontSize:"13px",padding:"4px 10px",linkStyle:{lineType:"round",lineRadius:5,lineWidth:1,lineColor:"rgb(187, 136, 34)"}}}},1156:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.theme2={name:"theme2",randomColor:!1,background:"#f8f8f8",highlightColor:"#50C9CE",marginH:45,marginV:10,fontFamily:"",bold:!1,italic:!1,textAlign:"left",rootTopic:{background:"#50C18A",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px",linkStyle:{lineType:"curve",lineWidth:2,lineColor:"rgb(113, 203, 45)"}},primaryTopic:{background:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(221, 170, 68)",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px",linkStyle:{lineType:"curve",lineWidth:2,lineColor:"#43a9ff"}},normalTopic:{background:"#fff",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc",linkStyle:{lineType:"round",lineRadius:5,lineWidth:1,lineColor:"#43a9ff"}}}},1157:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.theme3={name:"theme3",randomColor:!1,background:"#A9DEF9",highlightColor:"#50C9CE",marginH:50,marginV:20,fontFamily:"",bold:!1,italic:!1,textAlign:"left",rootTopic:{background:"#FF99C8",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px",linkStyle:{lineType:"curve",lineWidth:2,lineColor:"rgb(113, 203, 45)"}},primaryTopic:{background:"#FCF6BD",borderWidth:"1px",borderStyle:"solid",borderColor:"#E4C1F9",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px",linkStyle:{lineType:"curve",lineWidth:2,lineColor:"#43a9ff"}},normalTopic:{background:"#E4FDE1",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc",linkStyle:{lineType:"round",lineRadius:5,lineWidth:1,lineColor:"#43a9ff"}}}},1158:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.theme4={name:"theme3",randomColor:!1,background:"#CCFBFE",highlightColor:"#50C9CE",marginH:50,marginV:20,fontFamily:"",bold:!1,italic:!1,textAlign:"left",rootTopic:{background:"#CD8987",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px",linkStyle:{lineType:"curve",lineWidth:2,lineColor:"rgb(113, 203, 45)"}},primaryTopic:{background:"#CDACA1",borderWidth:"1px",borderStyle:"solid",borderColor:"#E4C1F9",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px",linkStyle:{lineType:"line",lineWidth:2,lineColor:"#43a9ff"}},normalTopic:{background:"#CDCACC",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc",linkStyle:{lineType:"line",lineRadius:5,lineWidth:1,lineColor:"#43a9ff"}}}},1159:function(module,exports,__webpack_require__){"use strict";(function(module){var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(132).withSource,__STORY__="import * as React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { BaseDemo } from '../common/base-demo';\nimport { Diagram } from '@blink-mind/renderer-react';\nimport richTextEditorPlugin from '@blink-mind/plugin-rich-text-editor';\n\n// @ts-ignore\nimport simpleTextEditorMdZh from './simple-text-editor-zh.md';\n// @ts-ignore\nimport simpleTextEditorMdEn from './simple-text-editor-en.md';\n// @ts-ignore\nimport richTextEditorMdZh from './plugin-rich-text-editor-zh.md';\n// @ts-ignore\nimport richTextEditorMdEn from './plugin-rich-text-editor-en.md';\n\nexport class SimpleTopicContentEditorDemo extends BaseDemo {\n  renderDiagram() {\n    return <Diagram model={this.state.model} onChange={this.onChange} />;\n  }\n}\n\nconst plugins = [richTextEditorPlugin()];\n\nexport class RichTextEditorPluginDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n}\n\nstoriesOf('topic-content-editor-demo', module)\n  .add('simple-text-editor', () => <SimpleTopicContentEditorDemo />, {\n    notes:{\n      markdown:{\n        en: simpleTextEditorMdEn,\n        zh: simpleTextEditorMdZh\n      }\n    }\n  })\n  .add('rich-text-editor', () => <RichTextEditorPluginDemo />, {\n    notes: {\n      markdown: {\n        en: richTextEditorMdEn,\n        zh: richTextEditorMdZh\n      }\n    }\n  });\n",__ADDS_MAP__={"topic-content-editor-demo--rich-text-editor":{startLoc:{col:7,line:45},endLoc:{col:3,line:52},startBody:{col:27,line:45},endBody:{col:61,line:45}},"topic-content-editor-demo--simple-text-editor":{startLoc:{col:7,line:37},endLoc:{col:3,line:44},startBody:{col:29,line:37},endBody:{col:67,line:37}}},React=__webpack_require__(0),react_1=__webpack_require__(80),base_demo_1=__webpack_require__(134),renderer_react_1=__webpack_require__(79),plugin_rich_text_editor_1=__webpack_require__(299),simple_text_editor_zh_md_1=__webpack_require__(1160),simple_text_editor_en_md_1=__webpack_require__(1161),plugin_rich_text_editor_zh_md_1=__webpack_require__(1162),plugin_rich_text_editor_en_md_1=__webpack_require__(1163),SimpleTopicContentEditorDemo=function(_super){function SimpleTopicContentEditorDemo(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SimpleTopicContentEditorDemo,_super),SimpleTopicContentEditorDemo.prototype.renderDiagram=function(){return React.createElement(renderer_react_1.Diagram,{model:this.state.model,onChange:this.onChange})},SimpleTopicContentEditorDemo}(base_demo_1.BaseDemo);exports.SimpleTopicContentEditorDemo=SimpleTopicContentEditorDemo;var plugins=[plugin_rich_text_editor_1.default()],RichTextEditorPluginDemo=function(_super){function RichTextEditorPluginDemo(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RichTextEditorPluginDemo,_super),RichTextEditorPluginDemo.prototype.renderDiagram=function(){return React.createElement(renderer_react_1.Diagram,{model:this.state.model,onChange:this.onChange,plugins:plugins})},RichTextEditorPluginDemo}(base_demo_1.BaseDemo);exports.RichTextEditorPluginDemo=RichTextEditorPluginDemo,react_1.storiesOf("topic-content-editor-demo",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/index.stories.tsx",[],{},"/home/zhou/coding/awehook/blink-mind/stories/topic-content-editor-demo",{})).add("simple-text-editor",(function(){return React.createElement(SimpleTopicContentEditorDemo,null)}),{notes:{markdown:{en:simple_text_editor_en_md_1.default,zh:simple_text_editor_zh_md_1.default}}}).add("rich-text-editor",(function(){return React.createElement(RichTextEditorPluginDemo,null)}),{notes:{markdown:{en:plugin_rich_text_editor_en_md_1.default,zh:plugin_rich_text_editor_zh_md_1.default}}})}).call(this,__webpack_require__(67)(module))},1160:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="blink-mind 默认提供的topic editor是一个简单的文本编辑器,不支持富文本编辑。"},1161:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="The topic editor provided by blink-mind by default is a simple text editor that does not support rich text editing."},1162:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="blink-mind 默认提供的topic editor是一个简单的文本编辑器,不支持富文本编辑。\n\n如果想要topic节点以及notes 的文本编辑器支持富文本编辑，可以使用框架提供的plugin-rich-text-editor.\n\n```jsx\nimport richTextEditorPlugin from \"@blink-mind/plugin-rich-text-editor\";\nconst plugins = [richTextEditorPlugin()];\n\nexport class RichTextEditorPluginDemo extends BaseDemo {\n\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n}\n```\n\n框架提供的plugin-rich-text-editor的代码实现如下：\n\n```jsx\nimport * as React from 'react';\nimport { TopicContentEditor } from '../components/topic-content-editor';\nimport { TopicDescEditor } from '../components/topic-desc-editor';\nexport default function RichTextEditorPlugin() {\n  return {\n    renderTopicContentEditor(props) {\n      return <TopicContentEditor {...props} />;\n    },\n\n    renderTopicDescEditor(props) {\n      return <TopicDescEditor {...props} />;\n    }\n  };\n}\n```\n具体的代码实现在[这里](https://github.com/awehook/blink-mind/tree/master/packages/plugin-rich-text-editor/src/components),\n\n如果我们想自定义topic的文本编辑器，可以自己写一个plugin, 在里面实现renderTopicContentEditor和renderTopicDescEditor函数"},1163:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="The topic editor provided by blink-mind by default is a simple text editor that does not support rich text editing.\n\nIf you want the topic editor and the notes editor to support rich text editing, you can use the plugin-rich-text-editor provided by the framework.\n\n```jsx\nimport richTextEditorPlugin from \"@blink-mind/plugin-rich-text-editor\";\nconst plugins = [richTextEditorPlugin()];\n\nexport class RichTextEditorPluginDemo extends BaseDemo {\n\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n}\n```\n\nThe code provided by the framework for plugin-rich-text-editor is implemented as follows:\n\n```jsx\nimport * as React from 'react';\nimport { TopicContentEditor } from '../components/topic-content-editor';\nimport { TopicDescEditor } from '../components/topic-desc-editor';\nexport default function RichTextEditorPlugin() {\n  return {\n    renderTopicContentEditor(props) {\n      return <TopicContentEditor {...props} />;\n    },\n\n    renderTopicDescEditor(props) {\n      return <TopicDescEditor {...props} />;\n    }\n  };\n}\n```\n\nThe specific code is implemented in [here](https://github.com/awehook/blink-mind/tree/master/packages/plugin-rich-text-editor/src/components),\n\nIf we want to customize the text editor of the topic, we can write a plugin ourselves, and implement the renderTopicContentEditor and renderTopicDescEditor functions in it."},1164:function(module,exports,__webpack_require__){"use strict";(function(module){var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,templateObject_3,templateObject_4,templateObject_5,withSourceLoader=__webpack_require__(132).withSource,__STORY__="import * as React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { BaseDemo } from '../common/base-demo';\nimport { Diagram, iconClassName } from '@blink-mind/renderer-react';\nimport styled from 'styled-components';\n\nconst ToolBar = styled.div`\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n`;\n\nconst ToolBarItem = styled.div`\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: ${props => (props.enable ? 'pointer' : 'not-allowed')};\n  color: ${props => (props.enable ? 'black' : 'grey')};\n  ${props =>\n    props.enable &&\n    `&:hover {\n    color: #106ba3;\n  }`};\n  display: inline-block;\n`;\n\nconst Icon = styled.div`\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n`;\n\nconst Container = styled.div`\n  width: 100%;\n  height: 100%;\n`;\n\nconst DiagramContainer = styled.div`\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n`;\n\nclass UndoRedoDemo extends BaseDemo {\n  onClickUndo = () => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run('undo', props);\n  };\n\n  onClickRedo = () => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run('redo', props);\n  };\n\n  renderToolbar() {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    const canUndo = controller.run('canUndo', props);\n    const canRedo = controller.run('canRedo', props);\n\n    return (\n      <ToolBar>\n        <ToolBarItem onClick={this.onClickUndo} enable={canUndo}>\n          <Icon className={iconClassName('undo')} />\n        </ToolBarItem>\n        <ToolBarItem onClick={this.onClickRedo} enable={canRedo}>\n          <Icon className={iconClassName('redo')} />\n        </ToolBarItem>\n      </ToolBar>\n    );\n  }\n  diagram: Diagram;\n  diagramRef = e => {\n    this.diagram = e;\n    this.setState({});\n  };\n  renderDiagram() {\n    return (\n      <Container>\n        {this.diagram && this.renderToolbar()}\n        <DiagramContainer>\n          <Diagram\n            model={this.state.model}\n            onChange={this.onChange}\n            ref={this.diagramRef}\n          />\n        </DiagramContainer>\n      </Container>\n    );\n  }\n}\n\nstoriesOf('undo-redo-demo', module).add(\n  'undo-redo',\n  () => <UndoRedoDemo />,\n  {}\n);\n",__ADDS_MAP__={"undo-redo-demo--undo-redo":{startLoc:{col:2,line:95},endLoc:{col:4,line:97},startBody:{col:2,line:96},endBody:{col:24,line:96}}},React=__webpack_require__(0),react_1=__webpack_require__(80),base_demo_1=__webpack_require__(134),renderer_react_1=__webpack_require__(79),styled_components_1=__webpack_require__(14),ToolBar=styled_components_1.default.div.withConfig({displayName:"ToolBar",componentId:"sc-1ejnq4o"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n"],["\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n"]))),ToolBarItem=styled_components_1.default.div.withConfig({displayName:"ToolBarItem",componentId:"sc-bffgc6"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: ",";\n  color: ",";\n  ",";\n  display: inline-block;\n"],["\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: ",";\n  color: ",";\n  ",";\n  display: inline-block;\n"])),(function(props){return props.enable?"pointer":"not-allowed"}),(function(props){return props.enable?"black":"grey"}),(function(props){return props.enable&&"&:hover {\n    color: #106ba3;\n  }"})),Icon=styled_components_1.default.div.withConfig({displayName:"Icon",componentId:"sc-x0ja3g"})(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n"],["\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n"]))),Container=styled_components_1.default.div.withConfig({displayName:"Container",componentId:"sc-znnk04"})(templateObject_4||(templateObject_4=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n"],["\n  width: 100%;\n  height: 100%;\n"]))),DiagramContainer=styled_components_1.default.div.withConfig({displayName:"DiagramContainer",componentId:"sc-1yhveh5"})(templateObject_5||(templateObject_5=__makeTemplateObject(["\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n"],["\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n"]))),UndoRedoDemo=function(_super){function UndoRedoDemo(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.onClickUndo=function(){var props=_this.diagram.getDiagramProps();props.controller.run("undo",props)},_this.onClickRedo=function(){var props=_this.diagram.getDiagramProps();props.controller.run("redo",props)},_this.diagramRef=function(e){_this.diagram=e,_this.setState({})},_this}return __extends(UndoRedoDemo,_super),UndoRedoDemo.prototype.renderToolbar=function(){var props=this.diagram.getDiagramProps(),controller=props.controller,canUndo=controller.run("canUndo",props),canRedo=controller.run("canRedo",props);return React.createElement(ToolBar,null,React.createElement(ToolBarItem,{onClick:this.onClickUndo,enable:canUndo},React.createElement(Icon,{className:renderer_react_1.iconClassName("undo")})),React.createElement(ToolBarItem,{onClick:this.onClickRedo,enable:canRedo},React.createElement(Icon,{className:renderer_react_1.iconClassName("redo")})))},UndoRedoDemo.prototype.renderDiagram=function(){return React.createElement(Container,null,this.diagram&&this.renderToolbar(),React.createElement(DiagramContainer,null,React.createElement(renderer_react_1.Diagram,{model:this.state.model,onChange:this.onChange,ref:this.diagramRef})))},UndoRedoDemo}(base_demo_1.BaseDemo);react_1.storiesOf("undo-redo-demo",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/index.stories.tsx",[],{},"/home/zhou/coding/awehook/blink-mind/stories/undo-redo-demo",{})).add("undo-redo",(function(){return React.createElement(UndoRedoDemo,null)}),{})}).call(this,__webpack_require__(67)(module))},133:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TopicDirection={LEFT:"L",RIGHT:"R",BOTTOM:"B",MAIN:"M"},function(DiagramLayoutType){DiagramLayoutType[DiagramLayoutType.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",DiagramLayoutType[DiagramLayoutType.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",DiagramLayoutType[DiagramLayoutType.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",DiagramLayoutType[DiagramLayoutType.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(exports.DiagramLayoutType||(exports.DiagramLayoutType={})),exports.TopicVisualLevel={ROOT:0,PRIMARY:1,NORMAL:2},exports.BlockType={CONTENT:"CONTENT",DESC:"DESC"},exports.FocusMode={NORMAL:"NORMAL",EDITING_CONTENT:"EDITING_CONTENT",EDITING_DESC:"EDITING_DESC",SHOW_POPUP:"SHOW_POPUP",DRAGGING:"DRAGGING"},exports.TopicRelationship={ANCESTOR:"ANCESTOR",DESCENDANT:"DESCENDANT",SIBLING:"SIBLING",NONE:"NONE"}},134:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0),utils_1=__webpack_require__(298);__webpack_require__(932);var log=__webpack_require__(28).default("story:base-demo"),BaseDemo=function(_super){function BaseDemo(props){var _this=_super.call(this,props)||this;return _this.onChange=function(model){_this.setState({model:model})},_this.initModel(),_this}return __extends(BaseDemo,_super),BaseDemo.prototype.initModel=function(){var model=utils_1.generateSimpleModel();log("initModel:",model),this.state={model:model}},BaseDemo.prototype.renderDiagram=function(){return null},BaseDemo.prototype.render=function(){return React.createElement("div",{className:"app"},this.renderDiagram())},BaseDemo}(React.Component);exports.BaseDemo=BaseDemo},158:function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(1155)),__export(__webpack_require__(1156)),__export(__webpack_require__(1157)),__export(__webpack_require__(1158))},278:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var immutable_1=__webpack_require__(3),Block=function(_super){function Block(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Block,_super),Object.defineProperty(Block.prototype,"data",{get:function(){return this.get("data")},enumerable:!0,configurable:!0}),Object.defineProperty(Block.prototype,"type",{get:function(){return this.get("type")},enumerable:!0,configurable:!0}),Block.create=function(obj){return new Block(obj)},Block.createList=function(obj){if(immutable_1.List.isList(obj)||Array.isArray(obj))return immutable_1.List(obj.map(Block.create));throw new Error("Block.createList only accepts Array or List, but you passed it: "+obj)},Block}(immutable_1.Record({type:null,key:null,data:null}));exports.Block=Block},279:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var types_1=__webpack_require__(133),immutable_1=__webpack_require__(3),block_1=__webpack_require__(278),Topic=function(_super){function Topic(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Topic,_super),Object.defineProperty(Topic.prototype,"key",{get:function(){return this.get("key")},enumerable:!0,configurable:!0}),Object.defineProperty(Topic.prototype,"parentKey",{get:function(){return this.get("parentKey")},enumerable:!0,configurable:!0}),Object.defineProperty(Topic.prototype,"collapse",{get:function(){return this.get("collapse")},enumerable:!0,configurable:!0}),Object.defineProperty(Topic.prototype,"subKeys",{get:function(){return this.get("subKeys")},enumerable:!0,configurable:!0}),Object.defineProperty(Topic.prototype,"blocks",{get:function(){return this.get("blocks")},enumerable:!0,configurable:!0}),Object.defineProperty(Topic.prototype,"relations",{get:function(){return this.get("relations")},enumerable:!0,configurable:!0}),Object.defineProperty(Topic.prototype,"style",{get:function(){return this.get("style")},enumerable:!0,configurable:!0}),Topic.prototype.getBlock=function(type){var index=this.blocks.findIndex((function(b){return b.type===type}));return-1===index?{index:index,block:null}:{index:index,block:this.blocks.get(index)}},Topic.fromJSON=function(obj){var key=obj.key,_a=obj.parentKey,parentKey=void 0===_a?null:_a,blocks=obj.blocks,_b=obj.subKeys,subKeys=void 0===_b?[]:_b,_c=obj.collapse;return new Topic({key:key,parentKey:parentKey,collapse:void 0!==_c&&_c,subKeys:immutable_1.List(subKeys),blocks:block_1.Block.createList(blocks)})},Topic.create=function(_a){var key=_a.key,_b=_a.parentKey,parentKey=void 0===_b?null:_b,_c=_a.content,content=void 0===_c?"new node":_c,_d=_a.subKeys,subKeys=void 0===_d?[]:_d,_e=_a.collapse,collapse=void 0!==_e&&_e,block=block_1.Block.create({type:types_1.BlockType.CONTENT,data:content,key:null});return new Topic({key:key,parentKey:parentKey,blocks:immutable_1.List([block]),subKeys:immutable_1.List(subKeys),collapse:collapse})},Topic}(immutable_1.Record({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));exports.Topic=Topic},298:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core_1=__webpack_require__(31);exports.generateSimpleModel=function generateSimpleModel(){return core_1.Model.create({rootTopicKey:"root",topics:[{key:"root",blocks:[{type:"CONTENT",data:"MainTopic"}],subKeys:["sub1","sub2"]},{key:"sub1",parentKey:"root",blocks:[{type:"CONTENT",data:"SubTopic1"}],subKeys:["sub1_1","sub1_2"],collapse:!1},{key:"sub1_1",parentKey:"sub1",blocks:[{type:"CONTENT",data:"SubTopic"}],collapse:!1},{key:"sub1_2",parentKey:"sub1",blocks:[{type:"CONTENT",data:"SubTopic"}],collapse:!1},{key:"sub2",subKeys:["sub2_1","sub2_2"],parentKey:"root",blocks:[{type:"CONTENT",data:"SubTopic2"}]},{key:"sub2_1",parentKey:"sub2",blocks:[{type:"CONTENT",data:"SubTopic"}],collapse:!1},{key:"sub2_2",parentKey:"sub2",blocks:[{type:"CONTENT",data:"SubTopic"}],collapse:!1}]})},exports.downloadFile=function downloadFile(url,filename){var link=document.createElement("a");link.href=url,link.download=filename,link.click()}},299:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var plugins_1=__webpack_require__(940);exports.default=plugins_1.default},31:function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0});var models_1=__webpack_require__(421);exports.models=models_1.default;var controller_1=__webpack_require__(807);exports.Controller=controller_1.Controller;var modifiers_1=__webpack_require__(426);exports.ModelModifier=modifiers_1.default,__export(__webpack_require__(133)),__export(__webpack_require__(421)),__export(__webpack_require__(810))},410:function(module,exports,__webpack_require__){"use strict";(function(module){Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(132).withSource,__webpack_require__(132).addSource;var react_1=__webpack_require__(80);localStorage.debug=["core:*","node:*","plugin:*","modifier"].join(","),react_1.configure((function loadStories(){var req=__webpack_require__(789);req.keys().forEach(req)}),module)}).call(this,__webpack_require__(67)(module))},421:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var block_1=__webpack_require__(278);exports.Block=block_1.Block;var config_1=__webpack_require__(422);exports.Config=config_1.Config;var model_1=__webpack_require__(805);exports.Model=model_1.Model;var topic_1=__webpack_require__(279);exports.Topic=topic_1.Topic;var data_1=__webpack_require__(424);exports.Data=data_1.Data;var modifiers_1=__webpack_require__(426);exports.Modifiers=modifiers_1.default,function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__(427)),exports.default={Block:block_1.Block,Config:config_1.Config,Model:model_1.Model,Topic:topic_1.Topic,Data:data_1.Data}},422:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var types_1=__webpack_require__(133),immutable_1=__webpack_require__(3),theme_1=__webpack_require__(423),defaultConfigRecord={readOnly:!1,allowUndo:!0,layoutDir:types_1.DiagramLayoutType.LEFT_AND_RIGHT,theme:theme_1.defaultTheme},Config=function(_super){function Config(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Config,_super),Object.defineProperty(Config.prototype,"layoutDir",{get:function(){return this.get("layoutDir")},enumerable:!0,configurable:!0}),Object.defineProperty(Config.prototype,"readOnly",{get:function(){return this.get("readOnly")},enumerable:!0,configurable:!0}),Object.defineProperty(Config.prototype,"allowUndo",{get:function(){return this.get("allowUndo")},enumerable:!0,configurable:!0}),Object.defineProperty(Config.prototype,"theme",{get:function(){return this.get("theme")},enumerable:!0,configurable:!0}),Config.fromJSON=function(obj){return new Config(obj)},Config}(immutable_1.Record(defaultConfigRecord));exports.Config=Config},423:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__(804))},424:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var is_plain_object_1=__webpack_require__(294),immutable_1=__webpack_require__(3),Data=function(){function Data(){}return Data.create=function(attrs){if(void 0===attrs&&(attrs={}),immutable_1.Map.isMap(attrs))return attrs;if(is_plain_object_1.default(attrs))return Data.fromJSON(attrs);throw new Error("`Data.create` only accepts objects or maps, but you passed it: "+attrs)},Data.fromJSON=function(object){return immutable_1.Map(object)},Data}();exports.Data=Data},425:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createKey=function createKey(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){var r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)}))}},426:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var types_1=__webpack_require__(133),topic_1=__webpack_require__(279),block_1=__webpack_require__(278),utils_1=__webpack_require__(425),utils_2=__webpack_require__(427),log=__webpack_require__(28).default("modifier");function focusTopic(_a){var model=_a.model,topicKey=_a.topicKey,focusMode=_a.focusMode;return log("focus topic"),topicKey!==model.focusKey&&(model=model.set("focusKey",topicKey)),focusMode!==model.focusMode&&(model=model.set("focusMode",focusMode)),model}exports.default={addChild:function addChild(_a){var model=_a.model,topicKey=_a.topicKey;log("addChild:",topicKey);var topic=model.getTopic(topicKey);if(topic){var child_1=topic_1.Topic.create({key:utils_1.createKey(),parentKey:topic.key});return topic=topic.set("collapse",!1).update("subKeys",(function(subKeys){return subKeys.push(child_1.key)})),focusTopic({model:model=model.update("topics",(function(topics){return topics.set(topicKey,topic).set(child_1.key,child_1)})),topicKey:child_1.key,focusMode:types_1.FocusMode.EDITING_CONTENT})}return model},addSibling:function addSibling(_a){var model=_a.model,topicKey=_a.topicKey;if(topicKey===model.rootTopicKey)return model;var topic=model.getTopic(topicKey);if(topic){var pItem=model.getTopic(topic.parentKey),idx_1=pItem.subKeys.indexOf(topicKey),sibling_1=topic_1.Topic.create({key:utils_1.createKey(),parentKey:pItem.key});return focusTopic({model:model=model.update("topics",(function(topics){return topics.set(sibling_1.key,sibling_1)})).updateIn(["topics",pItem.key,"subKeys"],(function(subKeys){return subKeys.insert(idx_1+1,sibling_1.key)})),topicKey:sibling_1.key,focusMode:types_1.FocusMode.EDITING_CONTENT})}return model},toggleCollapse:function toggleCollapse(_a){var model=_a.model,topicKey=_a.topicKey,topic=model.getTopic(topicKey);return topic&&0!==topic.subKeys.size&&(topic=topic.merge({collapse:!topic.collapse}),model=model.updateIn(["topics",topic.key,"collapse"],(function(collapse){return!collapse}))),model},focusTopic:focusTopic,deleteTopic:function deleteTopic(_a){var model=_a.model,topicKey=_a.topicKey;if(topicKey===model.rootTopicKey)return model;var item=model.getTopic(topicKey);return item&&(model=model.withMutations((function(m){m.update("topics",(function(topics){topics=topics.delete(topicKey);var deleteKeys=utils_2.getAllSubTopicKeys(model,topicKey);return topics=topics.withMutations((function(t){deleteKeys.forEach((function(dKey){t.delete(dKey)}))}))})),m.updateIn(["topics",item.parentKey,"subKeys"],(function(subKeys){return subKeys.delete(subKeys.indexOf(topicKey))})),m.focusKey===topicKey&&m.set("focusKey",null).set("focusMode",null)}))),model},setContent:function setContent(_a){var model=_a.model,topicKey=_a.topicKey,content=_a.content,topic=model.getTopic(topicKey);if(topic){var _b=topic.getBlock(types_1.BlockType.CONTENT),index=_b.index;return _b.block.data!==content&&(model=model.updateIn(["topics",topicKey,"blocks",index,"data"],(function(data){return content}))),focusTopic({model:model,topicKey:topicKey,focusMode:types_1.FocusMode.EDITING_CONTENT})}return model},setDesc:function setDesc(_a){var model=_a.model,topicKey=_a.topicKey,desc=_a.desc,topic=model.getTopic(topicKey);if(topic){var _b=topic.getBlock(types_1.BlockType.DESC),index=_b.index,block=_b.block;return-1===index?model=model.updateIn(["topics",topicKey,"blocks"],(function(blocks){return blocks.push(block_1.Block.create({type:types_1.BlockType.DESC,data:desc}))})):block.data!==desc&&(model=model.updateIn(["topics",topicKey,"blocks",index,"data"],(function(data){return desc}))),focusTopic({model:model,topicKey:topicKey,focusMode:types_1.FocusMode.EDITING_DESC})}return model},setStyle:function setStyle(_a){var model=_a.model,topicKey=_a.topicKey,style=_a.style,topic=model.getTopic(topicKey);return topic&&style!==topic.style&&(model=model.updateIn(["topics",topicKey,"style"],(function(s){return style}))),model},setTheme:function setTheme(_a){var model=_a.model,theme=_a.theme;return model=model.setIn(["config","theme"],theme)},setLayoutDir:function setLayoutDir(_a){var model=_a.model,layoutDir=_a.layoutDir;return model.config.layoutDir===layoutDir?model:model=model.setIn(["config","layoutDir"],layoutDir)}}},427:function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=this&&this.__spread||function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar};Object.defineProperty(exports,"__esModule",{value:!0});var types_1=__webpack_require__(133);exports.getAllSubTopicKeys=function getAllSubTopicKeys(model,topicKey){var item=model.getTopic(topicKey),res=[];if(item.subKeys.size>0){var subKeys=item.subKeys.toArray();res.push.apply(res,__spread(subKeys)),res=subKeys.reduce((function(acc,key){return acc.push.apply(acc,__spread(getAllSubTopicKeys(model,key))),acc}),res)}return res},exports.getRelationship=function getRelationship(model,srcKey,dstKey){var srcTopic=model.getTopic(srcKey),dstTopic=model.getTopic(dstKey);if(srcTopic&&dstTopic){if(srcTopic.parentKey==dstTopic.parentKey)return types_1.TopicRelationship.SIBLING;for(var pTopic=srcTopic;pTopic.parentKey;){if(pTopic.parentKey===dstTopic.key)return types_1.TopicRelationship.DESCENDANT;pTopic=model.getParentTopic(pTopic.key)}for(pTopic=dstTopic;pTopic.parentKey;){if(pTopic.parentKey===srcTopic.key)return types_1.TopicRelationship.ANCESTOR;pTopic=model.getParentTopic(pTopic.key)}}return types_1.TopicRelationship.NONE}},428:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,templateObject_3,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(31),debug_1=__webpack_require__(28),utils_1=__webpack_require__(43),log=debug_1.default("node:topic-widget"),Node=styled_components_1.default.div.withConfig({displayName:"Node",componentId:"sc-ighcvl"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"],["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(props){return props.topicDirection===core_1.TopicDirection.RIGHT?"row":"row-reverse"})),NodeChildren=styled_components_1.default.div.withConfig({displayName:"NodeChildren",componentId:"sc-9mo9vu"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  position: relative;\n  padding: ",";\n"],["\n  position: relative;\n  padding: ",";\n"])),(function(props){return props.dir===core_1.TopicDirection.RIGHT?"0 0 0 "+props.marginH+"px":"0 "+props.marginH+"px 0 0"})),NodeTopic=styled_components_1.default.div.withConfig({displayName:"NodeTopic",componentId:"sc-b82lp8"})(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(props){return props.topicDirection===core_1.TopicDirection.RIGHT?"row":"row-reverse"})),TopicWidget=function(_super){function TopicWidget(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TopicWidget,_super),TopicWidget.prototype.renderSubTopics=function(){var props=this.props,controller=props.controller,model=props.model,topicKey=props.topicKey,dir=props.dir,topics=(props.saveRef,props.getRef,model.getTopic(topicKey).subKeys.toArray()),res=controller.run("createSubTopics",{props:props,topics:topics});if(!res)return null;var subTopics=res.subTopics,subLinks=controller.run("renderSubLinks",props);return React.createElement(NodeChildren,{dir:dir,marginH:model.config.theme.marginH},subTopics," ",subLinks)},TopicWidget.prototype.componentDidUpdate=function(){this.layoutLinks()},TopicWidget.prototype.componentDidMount=function(){this.layoutLinks()},TopicWidget.prototype.layoutLinks=function(){var _a=this.props,getRef=_a.getRef,topicKey=_a.topicKey,links=getRef(utils_1.linksRefKey(topicKey));links&&links.layout()},TopicWidget.prototype.render=function(){log("render");var props=this.props,controller=props.controller,topicKey=props.topicKey,dir=props.dir,saveRef=props.saveRef,topicStyle=controller.run("getTopicStyle",props),propsMore=__assign(__assign({},props),{topicStyle:topicStyle}),topicContent=controller.run("renderTopicContent",propsMore);return React.createElement(Node,{topicDirection:dir},React.createElement(NodeTopic,{topicDirection:dir,ref:saveRef(utils_1.topicRefKey(topicKey))},topicContent),this.renderSubTopics())},TopicWidget}(React.Component);exports.TopicWidget=TopicWidget},43:function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLinkKey=function getLinkKey(fromKey,toKey){return"link-"+fromKey+"-"+toKey},exports.centerY=function centerY(rect){return(rect.top+rect.bottom)/2},exports.centerX=function centerX(rect){return(rect.left+rect.right)/2},exports.centerPointX=function centerPointX(p1,p2){return(p1.x+p2.x)/2},exports.centerPointY=function centerPointY(p1,p2){return(p1.y+p2.y)/2},__export(__webpack_require__(818)),__export(__webpack_require__(819))},441:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),ContentEditable=__webpack_require__(14).default.span.withConfig({displayName:"ContentEditable",componentId:"sc-1rg8bku"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  &:focus {\n    outline: 0px;\n  }\n"],["\n  &:focus {\n    outline: 0px;\n  }\n"]))),SimpleTextEditor=function(_super){function SimpleTextEditor(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.domNodeRef=function(ref){_this.domNode=ref},_this.emitChange=function(){var html=_this.domNode.innerHTML;_this.props.onChange&&html!==_this.lastHtml&&_this.props.onChange(html),_this.lastHtml=html},_this}return __extends(SimpleTextEditor,_super),SimpleTextEditor.prototype.render=function(){return React.createElement(ContentEditable,{ref:this.domNodeRef,onBlur:this.emitChange.bind(this),contentEditable:!this.props.readOnly,suppressContentEditableWarning:!0},this.props.editorValue)},SimpleTextEditor.prototype.shouldComponentUpdate=function(nextProps){return nextProps.html!==this.domNode.innerHTML},SimpleTextEditor}(React.Component);exports.SimpleTextEditor=SimpleTextEditor},442:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),renderer_react_1=__webpack_require__(79),styled_components_1=__webpack_require__(14),awehook_rich_markdown_editor_1=__webpack_require__(942),NodeContent=(__webpack_require__(28).default("node:topic-content-editor"),styled_components_1.default.div.withConfig({displayName:"NodeContent",componentId:"sc-hn5w8m"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n"],["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n"])),(function(props){return props.readOnly?null:"white"}),(function(props){return props.readOnly?"pointer":"text"}))),RichTextEditor=function(_super){function RichTextEditor(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.onMouseDown=function(e){e.stopPropagation()},_this.onMouseMove=function(e){e.stopPropagation()},_this.onChange=function(value){},_this.getCustomizeProps=function(){return null},_this}return __extends(RichTextEditor,_super),RichTextEditor.prototype.render=function(){var _a=this.props,topicKey=_a.topicKey,saveRef=_a.saveRef,_b=this.getCustomizeProps(),block=_b.block,readOnly=_b.readOnly,refKeyPrefix=_b.refKeyPrefix,content=block.data;if(null==content)return null;var key=refKeyPrefix+"-"+topicKey;return React.createElement(NodeContent,{key:key,readOnly:readOnly,ref:saveRef(key),onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove},React.createElement(awehook_rich_markdown_editor_1.default,{editorValue:content,readOnly:readOnly,onChange:this.onChange}))},RichTextEditor}(renderer_react_1.BaseWidget);exports.RichTextEditor=RichTextEditor},486:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__(939))},494:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a="## Model serialization and deserialization\n\nThe framework provides the plugin plugin-json-serializer to implement serialization and deserialization of json.\n\n### Serializer\n\nPlugin-json-serializer implements the middleware function: serializeModel\n\nThe outer layer can call controller.run('serializeModel', props) to serialize model to json.\n\n```js\nconst props = this.diagram.getDiagramProps();\nconst { controller } = props;\nconst json = controller.run('serializeModel', props);\nconst jsonStr = JSON.stringify(json);\n```\n\n### Deserializer\n\nPlugin-json-serializer implements the middleware function: deserializeModel\n\nThe outer layer can call controller.run('deserializeModel', props) to deserialize json to model.\n\n```js\nlet obj = JSON.parse(txt);\nlet model = controller.run('deserializeModel', { controller, obj });\n```"},495:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a="## 序列化 Model\n\n框架提供了默认的插件 plugin-json-serializer 来实现 json 的序列化和反序列化.\n\n### 序列化\n\nplugin-json-serializer 实现了 serializeModel 的方法\n\n在外层可以通过 controller.run('serializeModel', props) 来将 model 序列化为 json.\n\n```js\nconst props = this.diagram.getDiagramProps();\nconst { controller } = props;\nconst json = controller.run('serializeModel', props);\nconst jsonStr = JSON.stringify(json);\n```\n\n### 反序列化\n\nplugin-json-serializer 实现了 deserializeModel 的方法\n\n在外层可以通过 controller.run('deserializeModel', props) 来将 json 反序列化为 model.\n\n```js\nlet obj = JSON.parse(txt);\nlet model = controller.run('deserializeModel', { controller, obj });\n```"},497:function(module,exports,__webpack_require__){__webpack_require__(498),__webpack_require__(611),module.exports=__webpack_require__(612)},519:function(module,exports){},612:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80),_storybook_theming__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(479),_storybook_addon_notes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(481);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.addParameters)({options:{theme:_storybook_theming__WEBPACK_IMPORTED_MODULE_1__.themes.dark}}),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.addDecorator)(_storybook_addon_notes__WEBPACK_IMPORTED_MODULE_2__.withNotes),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)((function loadStories(){__webpack_require__(410)}),module)}.call(this,__webpack_require__(344)(module))},64:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var base_widget_1=__webpack_require__(815);exports.BaseWidget=base_widget_1.BaseWidget;var save_ref_1=__webpack_require__(816);exports.SaveRef=save_ref_1.SaveRef;var drag_scroll_widget_1=__webpack_require__(817);exports.DragScrollWidget=drag_scroll_widget_1.DragScrollWidget},76:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=__webpack_require__(31),immutable_1=__webpack_require__(3),log=__webpack_require__(28).default("plugin:operation");exports.OpType={TOGGLE_COLLAPSE:"TOGGLE_COLLAPSE",ADD_CHILD:"ADD_CHILD",ADD_SIBLING:"ADD_SIBLING",DELETE_TOPIC:"DELETE_TOPIC",FOCUS_TOPIC:"FOCUS_TOPIC",SET_STYLE:"SET_STYLE",SET_TOPIC_CONTENT:"SET_TOPIC_CONTENT",SET_TOPIC_DESC:"SET_TOPIC_DESC",START_EDITING_CONTENT:"START_EDITING_CONTENT",START_EDITING_DESC:"START_EDITING_DESC",DRAG_AND_DROP:"DRAG_AND_DROP"},exports.OperationPlugin=function OperationPlugin(){var OpMap=new Map([[exports.OpType.TOGGLE_COLLAPSE,core_1.ModelModifier.toggleCollapse],[exports.OpType.ADD_CHILD,core_1.ModelModifier.addChild],[exports.OpType.ADD_SIBLING,core_1.ModelModifier.addSibling],[exports.OpType.DELETE_TOPIC,core_1.ModelModifier.deleteTopic],[exports.OpType.FOCUS_TOPIC,core_1.ModelModifier.focusTopic],[exports.OpType.SET_STYLE,core_1.ModelModifier.setStyle],[exports.OpType.SET_TOPIC_CONTENT,core_1.ModelModifier.setContent],[exports.OpType.SET_TOPIC_DESC,core_1.ModelModifier.setDesc],[exports.OpType.START_EDITING_CONTENT,function(_a){var model=_a.model,topicKey=_a.topicKey;return core_1.ModelModifier.focusTopic({model:model,topicKey:topicKey,focusMode:core_1.FocusMode.EDITING_CONTENT})}],[exports.OpType.START_EDITING_DESC,function(_a){var model=_a.model,topicKey=_a.topicKey,desc=model.getTopic(topicKey).getBlock(core_1.BlockType.DESC);return null!=desc.block&&null!=desc.block.data||(model=core_1.ModelModifier.setDesc({model:model,topicKey:topicKey,desc:""})),core_1.ModelModifier.focusTopic({model:model,topicKey:topicKey,focusMode:core_1.FocusMode.EDITING_DESC})}],[exports.OpType.DRAG_AND_DROP,function dragAndDrop(props){var srcKey=props.srcKey,dstKey=props.dstKey,dropDir=props.dropDir,model=props.model,srcTopic=model.getTopic(srcKey),dstTopic=model.getTopic(dstKey),srcParentKey=srcTopic.parentKey,srcParentSubKeys=model.getTopic(srcParentKey).subKeys,srcIndex=srcParentSubKeys.indexOf(srcKey);if(srcParentSubKeys=srcParentSubKeys.delete(srcIndex),"in"===dropDir){var dstSubKeys_1=dstTopic.subKeys;dstSubKeys_1=dstSubKeys_1.push(srcKey),model=model.withMutations((function(m){m.setIn(["topics",srcParentKey,"subKeys"],srcParentSubKeys).setIn(["topics",srcKey,"parentKey"],dstKey).setIn(["topics",dstKey,"subKeys"],dstSubKeys_1).setIn(["topics",dstKey,"collapse"],!1)}))}else{var dstParentKey_1=dstTopic.parentKey,dstParentSubKeys_1=model.getTopic(dstParentKey_1).subKeys,dstIndex=dstParentSubKeys_1.indexOf(dstKey);if(srcParentKey===dstParentKey_1){var newDstParentSubKeys_1=immutable_1.List();dstParentSubKeys_1.forEach((function(key){key!==srcKey&&(newDstParentSubKeys_1=key===dstKey?"prev"===dropDir?newDstParentSubKeys_1.push(srcKey).push(key):newDstParentSubKeys_1.push(key).push(srcKey):newDstParentSubKeys_1.push(key))})),model=model.withMutations((function(m){m.setIn(["topics",dstParentKey_1,"subKeys"],newDstParentSubKeys_1)}))}else"prev"===dropDir?dstParentSubKeys_1=dstParentSubKeys_1.insert(dstIndex,srcKey):"next"===dropDir&&(dstParentSubKeys_1=dstParentSubKeys_1.insert(dstIndex+1,srcKey)),model=model.withMutations((function(m){m.setIn(["topics",srcParentKey,"subKeys"],srcParentSubKeys).setIn(["topics",srcKey,"parentKey"],dstParentKey_1).setIn(["topics",dstParentKey_1,"subKeys"],dstParentSubKeys_1).setIn(["topics",dstParentKey_1,"collapse"],!1)}))}return model}]]),undoStack=immutable_1.Stack(),redoStack=immutable_1.Stack();return{getAllowUndo:function(props){var model=props.model,opType=props.opType;if(opType)switch(opType){case exports.OpType.FOCUS_TOPIC:case exports.OpType.START_EDITING_CONTENT:return!1}return model.config.allowUndo},getUndoRedoStack:function(){return{undoStack:undoStack,redoStack:redoStack}},setUndoStack:function(props){log("setUndoStack",props.undoStack),undoStack=props.undoStack},setRedoStack:function(props){log("setRedoStack",props.redoStack),redoStack=props.redoStack},canUndo:function(props){var controller=props.controller,undoStack=controller.run("getUndoRedoStack",props).undoStack,allowUndo=controller.run("getAllowUndo",props);return undoStack.size>0&&allowUndo},canRedo:function(props){var controller=props.controller,redoStack=controller.run("getUndoRedoStack",props).redoStack,allowUndo=controller.run("getAllowUndo",props);return redoStack.size>0&&allowUndo},undo:function(props){var controller=props.controller,model=props.model;if(controller.run("getAllowUndo",props)){var _a=controller.run("getUndoRedoStack",props),undoStack=_a.undoStack,redoStack=_a.redoStack,newModel=undoStack.peek();newModel&&(controller.run("setUndoStack",__assign(__assign({},props),{undoStack:undoStack.shift()})),controller.run("setRedoStack",__assign(__assign({},props),{redoStack:redoStack.push(model)})),log(newModel),controller.change(newModel))}},redo:function(props){var controller=props.controller,model=props.model;if(controller.run("getAllowUndo",props)){var _a=controller.run("getUndoRedoStack",props),undoStack=_a.undoStack,redoStack=_a.redoStack,newModel=redoStack.peek();newModel&&(controller.run("setUndoStack",__assign(__assign({},props),{undoStack:undoStack.push(model)})),controller.run("setRedoStack",__assign(__assign({},props),{redoStack:redoStack.shift()})),controller.change(newModel))}},beforeOperation:function(props){},operation:function(props){var opType=props.opType,controller=props.controller,model=props.model;if(log("operation:",opType),controller.run("beforeOperation",props),OpMap.has(opType)){if(controller.run("getAllowUndo",props)){var undoStack_1=controller.run("getUndoRedoStack",props).undoStack;controller.run("setUndoStack",__assign(__assign({},props),{undoStack:undoStack_1.push(model)}))}var newModel=OpMap.get(opType)(props);controller.change(newModel)}controller.run("afterOperation",props)},afterOperation:function(props){}}}},789:function(module,exports,__webpack_require__){var map={"./customize-topic-context-menu-demo/index.stories.tsx":790,"./index.stories.tsx":410,"./serialize-demo/index.stories.jsx":938,"./theme-selector-demo/index.stories.tsx":1152,"./topic-content-editor-demo/index.stories.tsx":1159,"./undo-redo-demo/index.stories.tsx":1164};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=789},79:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var diagram_1=__webpack_require__(791);exports.Diagram=diagram_1.Diagram;var common_1=__webpack_require__(64);exports.BaseWidget=common_1.BaseWidget;var operation_1=__webpack_require__(76);exports.OpType=operation_1.OpType,function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__(43))},790:function(module,exports,__webpack_require__){"use strict";(function(module){var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(132).withSource,__STORY__="import * as React from 'react';\nimport { Diagram, OpType } from '@blink-mind/renderer-react';\nimport { BaseDemo } from '../common/base-demo';\nimport { MenuItem, MenuDivider } from '@blueprintjs/core';\nimport { storiesOf } from '@storybook/react';\nimport * as marked from 'marked';\n//@ts-ignore\nimport addTopicContextMenuMdEn from './add-topic-context-menu-en.md';\n//@ts-ignore\nimport addTopicContextMenuMdZh from './add-topic-context-menu-zh.md';\n//@ts-ignore\nimport changeDefaultTopicContextMenuMdZh from './change-default-topic-context-menu-zh.md';\n//@ts-ignore\nimport changeDefaultTopicContextMenuMdEn from './change-default-topic-context-menu-en.md';\n\nfunction onClickMyMenu(props) {\n  return function() {\n    const { topicKey, controller, model } = props;\n    alert(`this topic key is ${topicKey}`);\n    const topicStyle = controller.run('getTopicStyle', props);\n    alert(`this topic style is ${JSON.stringify(topicStyle)}`);\n  };\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys(props, next) {\n      const hotKeysMap = next();\n      hotKeysMap.set('MY_CUSTOM', {\n        label: 'MY_CUSTOM',\n        combo: 'shift + a',\n        onKeyDown: e => {\n          onClickMyMenu(props)();\n        }\n      });\n      return hotKeysMap;\n    }\n  };\n}\n\nfunction AddTopicContextMenuPlugin() {\n  return {\n    customizeTopicContextMenu(props, next) {\n      return (\n        <>\n          {next()}\n          <MenuDivider />\n          <MenuItem\n            icon=\"group-objects\"\n            label=\"Shift + A\"\n            text=\"my customize menu\"\n            onClick={onClickMyMenu(props)}\n          />\n        </>\n      );\n    }\n  };\n}\nconst plugins = [AddTopicContextMenuPlugin(), HotKeyPlugin()];\nexport class AddTopicContextMenuDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n}\n\nfunction ChangeDefaultTopicContextMenuPlugin() {\n  return {\n    customizeTopicContextMenu(props, next) {\n      let defaultMenus = next();\n      defaultMenus.splice(0, 1);\n      defaultMenus.splice(\n        1,\n        0,\n        <MenuItem\n          icon=\"group-objects\"\n          label=\"Shift + A\"\n          text=\"my customize menu\"\n          onClick={onClickMyMenu(props)}\n        />\n      );\n      return <>{defaultMenus}</>;\n    }\n  };\n}\n\nconst changeDefaultContextMenuPlugins = [\n  ChangeDefaultTopicContextMenuPlugin(),\n  HotKeyPlugin()\n];\nexport class ChangeDefaultTopicContextMenuDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={changeDefaultContextMenuPlugins}\n      />\n    );\n  }\n}\n\nstoriesOf('customize-topic-context-menu-demo', module)\n  .add('add-topic-context-menu', () => <AddTopicContextMenuDemo />, {\n    notes: {\n      markdown:{\n        en: addTopicContextMenuMdEn,\n        zh: addTopicContextMenuMdZh\n      },\n\n    }\n  })\n  .add(\n    'change-default-context-menu',\n    () => <ChangeDefaultTopicContextMenuDemo />,\n    {\n      notes: {\n        markdown: {\n          en: changeDefaultTopicContextMenuMdEn,\n          zh: changeDefaultTopicContextMenuMdZh\n        }\n      }\n    }\n  );\n",__ADDS_MAP__={"customize-topic-context-menu-demo--change-default-context-menu":{startLoc:{col:4,line:119},endLoc:{col:5,line:128},startBody:{col:4,line:120},endBody:{col:47,line:120}},"customize-topic-context-menu-demo--add-topic-context-menu":{startLoc:{col:7,line:109},endLoc:{col:3,line:117},startBody:{col:33,line:109},endBody:{col:66,line:109}}},React=__webpack_require__(0),renderer_react_1=__webpack_require__(79),base_demo_1=__webpack_require__(134),core_1=__webpack_require__(51),react_1=__webpack_require__(80),add_topic_context_menu_en_md_1=__webpack_require__(934),add_topic_context_menu_zh_md_1=__webpack_require__(935),change_default_topic_context_menu_zh_md_1=__webpack_require__(936),change_default_topic_context_menu_en_md_1=__webpack_require__(937);function onClickMyMenu(props){return function(){var topicKey=props.topicKey,controller=props.controller;props.model;alert("this topic key is "+topicKey);var topicStyle=controller.run("getTopicStyle",props);alert("this topic style is "+JSON.stringify(topicStyle))}}function HotKeyPlugin(){return{customizeHotKeys:function(props,next){var hotKeysMap=next();return hotKeysMap.set("MY_CUSTOM",{label:"MY_CUSTOM",combo:"shift + a",onKeyDown:function(e){onClickMyMenu(props)()}}),hotKeysMap}}}var plugins=[function AddTopicContextMenuPlugin(){return{customizeTopicContextMenu:function(props,next){return React.createElement(React.Fragment,null,next(),React.createElement(core_1.MenuDivider,null),React.createElement(core_1.MenuItem,{icon:"group-objects",label:"Shift + A",text:"my customize menu",onClick:onClickMyMenu(props)}))}}}(),HotKeyPlugin()],AddTopicContextMenuDemo=function(_super){function AddTopicContextMenuDemo(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AddTopicContextMenuDemo,_super),AddTopicContextMenuDemo.prototype.renderDiagram=function(){return React.createElement(renderer_react_1.Diagram,{model:this.state.model,onChange:this.onChange,plugins:plugins})},AddTopicContextMenuDemo}(base_demo_1.BaseDemo);exports.AddTopicContextMenuDemo=AddTopicContextMenuDemo;var changeDefaultContextMenuPlugins=[function ChangeDefaultTopicContextMenuPlugin(){return{customizeTopicContextMenu:function(props,next){var defaultMenus=next();return defaultMenus.splice(0,1),defaultMenus.splice(1,0,React.createElement(core_1.MenuItem,{icon:"group-objects",label:"Shift + A",text:"my customize menu",onClick:onClickMyMenu(props)})),React.createElement(React.Fragment,null,defaultMenus)}}}(),HotKeyPlugin()],ChangeDefaultTopicContextMenuDemo=function(_super){function ChangeDefaultTopicContextMenuDemo(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ChangeDefaultTopicContextMenuDemo,_super),ChangeDefaultTopicContextMenuDemo.prototype.renderDiagram=function(){return React.createElement(renderer_react_1.Diagram,{model:this.state.model,onChange:this.onChange,plugins:changeDefaultContextMenuPlugins})},ChangeDefaultTopicContextMenuDemo}(base_demo_1.BaseDemo);exports.ChangeDefaultTopicContextMenuDemo=ChangeDefaultTopicContextMenuDemo,react_1.storiesOf("customize-topic-context-menu-demo",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/index.stories.tsx",[],{},"/home/zhou/coding/awehook/blink-mind/stories/customize-topic-context-menu-demo",{})).add("add-topic-context-menu",(function(){return React.createElement(AddTopicContextMenuDemo,null)}),{notes:{markdown:{en:add_topic_context_menu_en_md_1.default,zh:add_topic_context_menu_zh_md_1.default}}}).add("change-default-context-menu",(function(){return React.createElement(ChangeDefaultTopicContextMenuDemo,null)}),{notes:{markdown:{en:change_default_topic_context_menu_en_md_1.default,zh:change_default_topic_context_menu_zh_md_1.default}}})}).call(this,__webpack_require__(67)(module))},791:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0),memoize_one_1=__webpack_require__(159),core_1=__webpack_require__(51),core_2=__webpack_require__(31),plugins_1=__webpack_require__(811);__webpack_require__(927),__webpack_require__(930);var log=__webpack_require__(28).default("node:Diagram"),Diagram=function(_super){function Diagram(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.resolveController=memoize_one_1.default((function(plugins,commands,TheDefaultPlugin){void 0===plugins&&(plugins=[]);var defaultPlugin=TheDefaultPlugin();_this.controller=new core_2.Controller({plugins:[plugins,defaultPlugin],commands:commands,construct:!1,onChange:_this.props.onChange}),_this.controller.run("onConstruct")})),_this}return __extends(Diagram,_super),Diagram.prototype.getDiagramProps=function(){return this.diagramProps},Diagram.prototype.renderHotkeys=function(){log("renderHotkeys");var hotKeys=this.diagramProps.controller.run("customizeHotKeys",this.diagramProps);if(null===hotKeys)return null;if(!(hotKeys instanceof Map))throw new TypeError("customizeHotKeys must return a Map");log(hotKeys);var children=[];return hotKeys.forEach((function(v,k){log(k,v),children.push(React.createElement(core_1.Hotkey,__assign({key:k},v,{global:!0})))})),React.createElement(core_1.Hotkeys,null,children)},Diagram.prototype.render=function(){var _a=this.props,commands=_a.commands,plugins=_a.plugins,model=_a.model;return this.resolveController(plugins,commands,plugins_1.DefaultPlugin),this.diagramProps=__assign(__assign({},this.props),{controller:this.controller,model:model,diagram:this}),this.controller.run("renderDiagram",this.diagramProps)},Diagram=__decorate([core_1.HotkeysTarget],Diagram)}(React.Component);exports.Diagram=Diagram},804:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultTheme={name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,fontFamily:"",bold:!1,italic:!1,textAlign:"left",rootTopic:{background:"#ff8200",color:"#fff",fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},primaryTopic:{background:"#e8eaec",borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(187,187,187)",borderRadius:"20px",color:"rgb(68,68,68)",fontSize:"17px",padding:"10px 15px 10px 15px",linkStyle:{lineType:"curve",lineWidth:3,lineColor:"rgb(113, 203, 45)"}},normalTopic:{background:"#fff",border:"1px solid #e8eaec",borderRadius:"20px",color:"rgb(68,68,68)",fontSize:"17px",padding:"4px 10px",linkStyle:{lineType:"curve",lineWidth:3,lineColor:"white"}}}},805:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var immutable_1=__webpack_require__(3),is_plain_object_1=__webpack_require__(294),data_1=__webpack_require__(424),types_1=__webpack_require__(133),config_1=__webpack_require__(422),topic_1=__webpack_require__(279),utils_1=__webpack_require__(425),defaultModelRecord={topics:immutable_1.Map(),data:null,config:null,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null},Model=function(_super){function Model(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Model,_super),Model.isModel=function(obj){return obj instanceof Model},Model.create=function(attrs){if(void 0===attrs&&(attrs=null),null==attrs)return Model.createEmpty();if(Model.isModel(attrs))return attrs;if(is_plain_object_1.default(attrs))return Model.fromJSON(attrs);throw new Error("`Value.create` only accepts objects or values, but you passed it: "+attrs)},Model.createEmpty=function(){var model=new Model,rootTopic=topic_1.Topic.create({key:utils_1.createKey()});return model.update("topics",(function(topics){return topics.set(rootTopic.key,rootTopic)})).set("rootTopicKey",rootTopic.key)},Model.fromJSON=function(object){var model=new Model,_a=object.data,data=void 0===_a?{}:_a,_b=object.topics,topics=void 0===_b?[]:_b,_c=object.config,config=void 0===_c?{}:_c,rootTopicKey=object.rootTopicKey,editorRootTopicKey=object.editorRootTopicKey;return void 0===editorRootTopicKey&&(editorRootTopicKey=rootTopicKey),model=(model=model.merge({rootTopicKey:rootTopicKey,editorRootTopicKey:editorRootTopicKey})).withMutations((function(model){topics.forEach((function(topic){model.update("topics",(function(topics){return topics.set(topic.key,topic_1.Topic.fromJSON(topic))}))})),model.set("config",config_1.Config.fromJSON(config)),model.set("data",data_1.Data.fromJSON(data))}))},Model.prototype.toJS=function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,data:this.data}},Object.defineProperty(Model.prototype,"topics",{get:function(){return this.get("topics")},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"config",{get:function(){return this.get("config")},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"rootTopicKey",{get:function(){return this.get("rootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"editorRootTopicKey",{get:function(){return this.get("editorRootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"focusKey",{get:function(){return this.get("focusKey")},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"focusMode",{get:function(){return this.get("focusMode")},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"editingContentKey",{get:function(){return this.focusMode===types_1.FocusMode.EDITING_CONTENT?this.focusKey:null},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"editingDescKey",{get:function(){return this.focusMode===types_1.FocusMode.EDITING_DESC?this.focusKey:null},enumerable:!0,configurable:!0}),Model.prototype.getTopic=function(key){return this.topics.get(key)},Model.prototype.getParentTopic=function(key){var topic=this.getTopic(key);return topic.parentKey?this.getTopic(topic.parentKey):null},Model.prototype.getTopicVisualLevel=function(key){for(var topic=this.getTopic(key),level=0;topic&&topic.key!==this.editorRootTopicKey;)level++,topic=this.getParentTopic(topic.key);return level},Object.defineProperty(Model.prototype,"rootTopic",{get:function(){return this.getTopic(this.rootTopicKey)},enumerable:!0,configurable:!0}),Model}(immutable_1.Record(defaultModelRecord));exports.Model=Model},807:function(module,exports,__webpack_require__){"use strict";var __values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=this&&this.__spread||function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=__webpack_require__(808),memoize_one_1=__webpack_require__(159),tiny_warning_1=__webpack_require__(809);__webpack_require__(28).default("core:controller");function compose(middleware){var e_1,_a;if(!Array.isArray(middleware))throw new TypeError("Middleware stack must be an array!");try{for(var middleware_1=__values(middleware),middleware_1_1=middleware_1.next();!middleware_1_1.done;middleware_1_1=middleware_1.next()){if("function"!=typeof middleware_1_1.value)throw new TypeError("Middleware must be composed of functions!")}}catch(e_1_1){e_1={error:e_1_1}}finally{try{middleware_1_1&&!middleware_1_1.done&&(_a=middleware_1.return)&&_a.call(middleware_1)}finally{if(e_1)throw e_1.error}}return function(context,next){var index=-1;return function dispatch(i){if(i<=index)throw new Error("next() called multiple times");index=i;var fn=middleware[i];i===middleware.length&&(fn=next);if(!fn)return null;try{return fn(context,dispatch.bind(null,i+1))}catch(err){throw err}}(0)}}var Controller=function(){function Controller(options){void 0===options&&(options={});var _a=options.diagram,diagram=void 0===_a?this:_a,_b=options.plugins,plugins=void 0===_b?[]:_b,onChange=options.onChange,readOnly=options.readOnly;this.diagram=diagram,this.readOnly=readOnly,this.onChange=onChange,this.middleware=new Map,function registerPlugin(controller,plugin){if(Array.isArray(plugin))plugin.forEach((function(p){return registerPlugin(controller,p)}));else if(null!=plugin)for(var key in plugin){var fn=plugin[key];controller.middleware[key]=controller.middleware[key]||[],controller.middleware[key].push(fn)}}(this,core_1.CorePlugin({plugins:plugins}))}return Controller.prototype.run=function(key){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var middleware=this.middleware,fns=middleware[key]||[];tiny_warning_1.default(0!==fns.length,"the middleware function "+key+" is not found!");var composedFn=memoize_one_1.default(compose)(fns);return composedFn.apply(void 0,__spread(args))},Controller.prototype.change=function(model){this.onChange(model)},Controller}();exports.Controller=Controller},808:function(module,exports,__webpack_require__){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=this&&this.__spread||function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CorePlugin=function CorePlugin(options){void 0===options&&(options={});var _a=options.plugins;return __spread(void 0===_a?[]:_a)}},810:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__(423))},811:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(812),layout_1=__webpack_require__(921),operation_1=__webpack_require__(76),style_1=__webpack_require__(922),event_1=__webpack_require__(923),hotkey_1=__webpack_require__(924),drag_and_drop_1=__webpack_require__(925);exports.DefaultPlugin=function DefaultPlugin(){return[react_1.ReactPlugin(),layout_1.LayoutPlugin(),operation_1.OperationPlugin(),style_1.StylePlugin(),event_1.EventPlugin(),hotkey_1.HotKeyPlugin(),drag_and_drop_1.DragAndDrop()]}},812:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var rendering_1=__webpack_require__(813);exports.ReactPlugin=function ReactPlugin(options){return void 0===options&&(options={}),[rendering_1.RenderingPlugin()]}},813:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(31),topic_content_widget_1=__webpack_require__(814),root_widget_1=__webpack_require__(820),topic_widget_1=__webpack_require__(428),topic_context_menu_1=__webpack_require__(821),topic_collapse_icon_1=__webpack_require__(822),style_editor_1=__webpack_require__(823),topic_sub_links_1=__webpack_require__(910),root_sublinks_1=__webpack_require__(911),utils_1=__webpack_require__(43),topic_highlight_1=__webpack_require__(912),common_1=__webpack_require__(64),mind_drag_scroll_widget_1=__webpack_require__(913),modals_1=__webpack_require__(914),topic_desc_icon_1=__webpack_require__(915),simple_topic_content_editor_1=__webpack_require__(916),modal_body_1=__webpack_require__(917),simple_topic_desc_editor_1=__webpack_require__(918),theme_1=__webpack_require__(919),context_menus_1=__webpack_require__(920),log=__webpack_require__(28).default("plugin:rendering");exports.RenderingPlugin=function RenderingPlugin(){var DiagramRoot=styled_components_1.default.div.withConfig({displayName:"DiagramRoot",componentId:"sc-1p6jkrx"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "],["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "])),(function(props){return props.theme.background}));return{renderDiagram:function(props){var model=props.model,controller=props.controller;return React.createElement(common_1.SaveRef,null,(function(saveRef,getRef){var widgetProps=__assign(__assign({},props),{saveRef:saveRef,getRef:getRef});return log("renderDiagram",model),React.createElement(theme_1.default,{theme:model.config.theme},React.createElement(DiagramRoot,null,React.createElement(mind_drag_scroll_widget_1.MindDragScrollWidget,__assign({},widgetProps)),controller.run("renderDiagramCustomize",widgetProps)))}))},renderDiagramCustomize:function(props){var controller=props.controller,model=props.model;return[controller.run("renderStyleEditor",__assign(__assign({},props),{topicKey:model.focusKey})),controller.run("renderModals",__assign(__assign({},props),{topicKey:model.focusKey}))]},renderModals:function(props){return React.createElement(modals_1.Modals,__assign({key:"modals"},props))},renderModal:function(props){var controller=props.controller,model=props.model,activeModalProps=controller.run("getActiveModalProps",props);if(activeModalProps&&"edit-desc"===activeModalProps.name){var modalProps=__assign(__assign({},props),{topicKey:model.focusKey});return React.createElement(modal_body_1.ModalBody,null,React.createElement(modal_body_1.ModalDescEditor,null,controller.run("renderTopicDescEditor",modalProps)))}return null},getActiveModalProps:function(props){var model=props.model;return model.focusKey&&model.focusMode===core_1.FocusMode.EDITING_DESC?{name:"edit-desc",title:"Edit Notes",style:{width:"50%",height:"600px"}}:null},renderDoc:function(_a){return _a.children},renderRootWidget:function(props){return React.createElement(root_widget_1.RootWidget,__assign({},props))},renderTopicWidget:function(props){return React.createElement(topic_widget_1.TopicWidget,__assign({},props))},renderTopicContent:function(props){return React.createElement(topic_content_widget_1.TopicContentWidget,__assign({},props))},renderTopicContextMenu:function(props){return React.createElement(topic_context_menu_1.TopicContextMenu,__assign({},props))},customizeTopicContextMenu:context_menus_1.customizeTopicContextMenu,renderTopicContentEditor:function(props){return log("renderTopicContentEditor",props),React.createElement(simple_topic_content_editor_1.SimpleTopicContentEditor,__assign({},props))},renderTopicDescEditor:function(props){return React.createElement(simple_topic_desc_editor_1.SimpleTopicDescEditor,__assign({},props))},renderTopicCollapseIcon:function(props){return React.createElement(topic_collapse_icon_1.TopicCollapseIcon,__assign({},props))},renderBlocks:function(props){var model=props.model,topicKey=props.topicKey,controller=props.controller,blocks=model.getTopic(topicKey).blocks,res=[],i=0;return blocks.forEach((function(block){var b=controller.run("renderBlock",__assign(__assign({},props),{block:block,blockKey:"block-"+i}));b&&(res.push(React.createElement(React.Fragment,{key:"block-"+i},b)),i++)})),res},renderBlock:function(props){var controller=props.controller;switch(props.block.type){case core_1.BlockType.CONTENT:return controller.run("renderTopicContentEditor",props);case core_1.BlockType.DESC:return React.createElement(topic_desc_icon_1.TopicDescIcon,__assign({},props))}return null},renderSubLinks:function(props){var saveRef=props.saveRef,topicKey=props.topicKey,topic=props.model.getTopic(topicKey);return 0===topic.subKeys.size||topic.collapse?null:React.createElement(topic_sub_links_1.TopicSubLinks,__assign({ref:saveRef(utils_1.linksRefKey(topicKey))},props))},renderRootSubLinks:function(props){var saveRef=props.saveRef,topicKey=props.topicKey;return 0===props.model.getTopic(topicKey).subKeys.size?null:React.createElement(root_sublinks_1.RootSubLinks,__assign({ref:saveRef(utils_1.linksRefKey(topicKey))},props))},renderFocusItemHighlight:function(props){var saveRef=props.saveRef;return React.createElement(topic_highlight_1.TopicHighlight,__assign({ref:saveRef("focus-highlight")},props))},renderRootWidgetOtherChildren:function(props){var controller=props.controller;return React.createElement(React.Fragment,null,controller.run("renderRootSubLinks",props),controller.run("renderFocusItemHighlight",props),controller.run("renderDragAndDropEffect",props))},renderStyleEditor:function(props){return React.createElement(style_editor_1.StyleEditor,__assign({key:"style-editor"},props))}}}},814:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(51),core_2=__webpack_require__(31),debug_1=__webpack_require__(28),common_1=__webpack_require__(64),operation_1=__webpack_require__(76),utils_1=__webpack_require__(43),log=debug_1.default("node:topic-content-widget"),TopicContent=styled_components_1.default.div.withConfig({displayName:"TopicContent",componentId:"sc-1oatw0b"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  display: flex;\n  align-items: center;\n  word-wrap: break-word;\n  white-space: pre-line;\n  cursor: pointer;\n  overflow: hidden;\n"],["\n  display: flex;\n  align-items: center;\n  word-wrap: break-word;\n  white-space: pre-line;\n  cursor: pointer;\n  overflow: hidden;\n"]))),TopicContentWithDropArea=styled_components_1.default.div.withConfig({displayName:"TopicContentWithDropArea",componentId:"sc-f2f4f5"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  position: relative;\n"],["\n  position: relative;\n"]))),TopicContentWidget=function(_super){function TopicContentWidget(props){var _this=_super.call(this,props)||this;return _this.onDragStart=function(ev){_this.run("handleTopicDragStart",__assign(__assign({},_this.props),{ev:ev}))},_this.onDragOver=function(ev){ev.preventDefault()},_this.onDragEnter=function(ev){_this.run("handleTopicDragEnter",__assign(__assign({},_this.props),{ev:ev,dropDir:"in"}))},_this.onDragLeave=function(ev){_this.run("handleTopicDragLeave",__assign(__assign({},_this.props),{ev:ev,dropDir:"in"}))},_this.onDrop=function(ev){_this.run("handleTopicDrop",__assign(__assign({},_this.props),{ev:ev,dropDir:"in"}))},_this.onClick=function(ev){_this.isDoubleClick=!1,log(ev.nativeEvent);var props=_this.props,controller=props.controller;setTimeout((function(){_this.isDoubleClick||controller.run("handleTopicClick",__assign(__assign({},props),{ev:ev}))}))},_this.onDoubleClick=function(ev){_this.isDoubleClick=!0,_this.props.controller.run("handleTopicDoubleClick",__assign(__assign({},_this.props),{ev:ev}))},_this.onContextMenu=function(ev){_this.props.controller.run("handleTopicContextMenu",__assign(__assign({},_this.props),{ev:ev})),_this.setState({showPopMenu:!0})},_this.handlePopMenuVisibleChange=function(visible){_this.setState({showPopMenu:visible})},_this.needRelocation=!1,_this.onClickCollapse=function(e){e.stopPropagation();var _a=_this.props,topicKey=_a.topicKey,getRef=_a.getRef;_this.needRelocation=!0,_this.oldCollapseIconRect=getRef(utils_1.collapseRefKey(topicKey)).getBoundingClientRect(),_this.operation(operation_1.OpType.TOGGLE_COLLAPSE,_this.props)},_this.state={dragEnter:!1,showPopMenu:!1},_this}return __extends(TopicContentWidget,_super),TopicContentWidget.prototype.renderContextMenu=function(){return this.props.controller.run("renderTopicContextMenu",this.props)},TopicContentWidget.prototype.onContextMenuClose=function(){},TopicContentWidget.prototype.componentDidUpdate=function(){if(this.needRelocation){var _a=this.props,getRef=_a.getRef,topicKey=_a.topicKey,setViewBoxScrollDelta=_a.setViewBoxScrollDelta,newRect=getRef(utils_1.collapseRefKey(topicKey)).getBoundingClientRect();log("newRect:",newRect),log("oldRect:",this.oldCollapseIconRect),setViewBoxScrollDelta(newRect.left-this.oldCollapseIconRect.left,newRect.top-this.oldCollapseIconRect.top),this.needRelocation=!1}},TopicContentWidget.prototype.render=function(){var props=this.props,saveRef=props.saveRef,topicKey=props.topicKey,model=props.model,controller=props.controller,topicStyle=props.topicStyle,dir=props.dir,draggable=model.editingContentKey!==topicKey,showPopMenu=this.state.showPopMenu,collapseIcon=controller.run("renderTopicCollapseIcon",__assign(__assign({},props),{onClickCollapse:this.onClickCollapse.bind(this)}));log(dir);var prevDropArea=controller.run("renderTopicDropArea",__assign(__assign({},props),{dropDir:"prev"})),nextDropArea=controller.run("renderTopicDropArea",__assign(__assign({},props),{dropDir:"next"})),dropEventHandlers={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return React.createElement(TopicContentWithDropArea,null,prevDropArea,React.createElement(TopicContent,__assign({style:topicStyle,draggable:draggable,ref:saveRef(utils_1.contentRefKey(topicKey)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onContextMenu:this.onContextMenu},dropEventHandlers),controller.run("renderBlocks",props),showPopMenu&&controller.run("renderTopicPopupMenu",__assign(__assign({},props),{handleVisibleChange:this.handlePopMenuVisibleChange,visible:!0}))),nextDropArea,dir!==core_2.TopicDirection.MAIN&&collapseIcon)},TopicContentWidget=__decorate([core_1.ContextMenuTarget],TopicContentWidget)}(common_1.BaseWidget);exports.TopicContentWidget=TopicContentWidget},815:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var BaseWidget=function(_super){function BaseWidget(props){return _super.call(this,props)||this}return __extends(BaseWidget,_super),BaseWidget.prototype.operation=function(opType,arg){this.props.controller.run("operation",__assign({opType:opType},arg))},BaseWidget.prototype.run=function(name,arg){this.props.controller.run(name,arg)},Object.defineProperty(BaseWidget.prototype,"topic",{get:function(){return this.props.model.getTopic(this.props.topicKey)},enumerable:!0,configurable:!0}),BaseWidget}(__webpack_require__(0).PureComponent);exports.BaseWidget=BaseWidget},816:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var SaveRef=function(_super){function SaveRef(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getRef=function(name){return _this[name]},_this.saveRef=function(name){return function(node){node&&(_this[name]=node,_this.fireListener(name,node))}},_this.observers=new Map,_this.fireListener=function(name,ref){var e_1,_a;if(_this.observers.has(name)){var listeners=_this.observers.get(name);try{for(var listeners_1=__values(listeners),listeners_1_1=listeners_1.next();!listeners_1_1.done;listeners_1_1=listeners_1.next()){(0,listeners_1_1.value)(name,ref)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{listeners_1_1&&!listeners_1_1.done&&(_a=listeners_1.return)&&_a.call(listeners_1)}finally{if(e_1)throw e_1.error}}}},_this.registerRefListener=function(name,listener){_this.observers.has(name)?_this.observers.get(name).push(listener):_this.observers.set(name,[listener])},_this}return __extends(SaveRef,_super),SaveRef.prototype.render=function(){return this.props.children(this.saveRef,this.getRef,this.registerRefListener.bind(this))},SaveRef}(__webpack_require__(0).Component);exports.SaveRef=SaveRef},817:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,React=__webpack_require__(0),resize_observer_polyfill_1=__webpack_require__(296),styled_components_1=__webpack_require__(14),log=__webpack_require__(28).default("node:drag-scroll-widget"),DragScrollView=styled_components_1.default.div.withConfig({displayName:"DragScrollView",componentId:"sc-imj7op"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"],["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),DragScrollContent=styled_components_1.default.div.withConfig({displayName:"DragScrollContent",componentId:"sc-5yqbdv"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  position: relative;\n  width: max-content;\n"],["\n  position: relative;\n  width: max-content;\n"]))),DragScrollWidget=function(_super){function DragScrollWidget(props){var _this=_super.call(this,props)||this;return _this.contentResizeCallback=function(entries,observer){if(_this.oldContentRect){var widgetStyle={width:_this.content.clientWidth+2*_this.viewBox.clientWidth,height:_this.content.clientHeight+2*_this.viewBox.clientHeight};_this.bigView.style.width=widgetStyle.width+"px",_this.bigView.style.height=widgetStyle.height+"px"}_this.oldContentRect=entries[0].contentRect},_this.contentResizeObserver=new resize_observer_polyfill_1.default(_this.contentResizeCallback),_this.contentRef=function(ref){ref&&(_this.content=ref,_this.contentResizeObserver.observe(_this.content))},_this.viewBoxRef=function(ref){ref&&(_this.viewBox=ref,_this.setViewBoxScroll(_this.viewBox.clientWidth,_this.viewBox.clientHeight))},_this.bigViewRef=function(ref){ref&&(_this.bigView=ref)},_this.setWidgetStyle=function(){_this.content&&_this.viewBox&&_this.bigView&&(_this.bigView.style.width=2*(_this.content.clientWidth+_this.viewBox.clientWidth)+"px",_this.bigView.style.height=2*(_this.content.clientHeight+_this.viewBox.clientHeight)+"px",_this.content.style.left=_this.viewBox.clientWidth+"px",_this.content.style.top=_this.viewBox.clientHeight+"px")},_this.setViewBoxScroll=function(left,top){log("setViewBoxScroll "+left+" "+top),_this.viewBox&&(_this.viewBox.scrollLeft=left,_this.viewBox.scrollTop=top)},_this.setViewBoxScrollDelta=function(deltaLeft,deltaTop){log("setViewBoxScrollDelta "+deltaLeft+" "+deltaTop),_this.viewBox&&(_this.viewBox.scrollLeft+=deltaLeft,_this.viewBox.scrollTop+=deltaTop)},_this.onMouseDown=function(e){var _a=_this.props,mouseKey=_a.mouseKey,needKeyPressed=_a.needKeyPressed,canDragFunc=_a.canDragFunc;if((!canDragFunc||canDragFunc())&&(0===e.button&&"left"===mouseKey||2===e.button&&"right"===mouseKey)){if(needKeyPressed&&!e.ctrlKey)return;_this._lastCoordX=_this.viewBox.scrollLeft+e.nativeEvent.clientX,_this._lastCoordY=_this.viewBox.scrollTop+e.nativeEvent.clientY,window.addEventListener("mousemove",_this.onMouseMove),window.addEventListener("mouseup",_this.onMouseUp)}},_this.onMouseUp=function(e){window.removeEventListener("mousemove",_this.onMouseMove),window.removeEventListener("mouseup",_this.onMouseUp)},_this.onMouseMove=function(e){_this.viewBox.scrollLeft=_this._lastCoordX-e.clientX,_this.viewBox.scrollTop=_this._lastCoordY-e.clientY},_this.handleContextMenu=function(e){e.preventDefault()},_this.state={widgetStyle:{width:"10000px",height:"10000px"}},_this}return __extends(DragScrollWidget,_super),DragScrollWidget.prototype.componentDidMount=function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)},DragScrollWidget.prototype.componentWillUnmount=function(){document.removeEventListener("contextmenu",this.handleContextMenu)},DragScrollWidget.prototype.render=function(){return React.createElement(DragScrollView,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},React.createElement("div",{style:this.state.widgetStyle,ref:this.bigViewRef},React.createElement(DragScrollContent,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))},DragScrollWidget.defaultProps={mouseKey:"left",needKeyPressed:!1},DragScrollWidget}(React.Component);exports.DragScrollWidget=DragScrollWidget},818:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0);function iconClassName(name){return"icon iconfont bm-"+name}exports.IconName={SHOW_MENU:"show-menu",CLOSE:"close",COLOR_PICKER:"color-picker",NOTES:"notes"},exports.iconClassName=iconClassName,exports.Icon=function Icon(iconName){return React.createElement("span",{className:iconClassName(iconName)})}},819:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.contentRefKey=function contentRefKey(key){return"content-"+key},exports.topicRefKey=function topicRefKey(key){return"topic-"+key},exports.linksRefKey=function linksRefKey(key){return"links-"+key},exports.linksSvgRefKey=function linksSvgRefKey(key){return"links-svg-"+key},exports.collapseRefKey=function collapseRefKey(key){return"collapse-"+key}},820:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(31),debug_1=__webpack_require__(28),utils_1=__webpack_require__(43),log=debug_1.default("RootNode"),LayerPart=styled_components_1.default.div.withConfig({displayName:"LayerPart",componentId:"sc-fnmzj9"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"],["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(props){return props.topicDirection===core_1.TopicDirection.LEFT?"flex-end":"flex-start"}),(function(props){return props.topicDirection===core_1.TopicDirection.LEFT?"15px 60px 15px 0px":"15px 0px 15px 60px"})),Topic=styled_components_1.default.div.withConfig({displayName:"Topic",componentId:"sc-ybya3t"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),RootWidget=function(_super){function RootWidget(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RootWidget,_super),RootWidget.prototype.renderPartTopics=function(topics,dir){var _a=this.props,controller=_a.controller,saveRef=_a.saveRef,res=controller.run("createSubTopics",{props:__assign(__assign({},this.props),{dir:dir,isRoot:!0}),topics:topics});if(!res)return null;var subTopics=res.subTopics,cxName="bm-layer-"+(dir===core_1.TopicDirection.LEFT?"left":"right");return React.createElement(LayerPart,{topicDirection:dir,ref:saveRef(cxName)},subTopics)},RootWidget.prototype.componentDidMount=function(){this.layout()},RootWidget.prototype.componentDidUpdate=function(){this.layout()},RootWidget.prototype.layout=function(){this.props.controller.run("layout",this.props)},RootWidget.prototype.render=function(){log("render");var props=this.props,model=props.model,topicKey=props.topicKey,saveRef=props.saveRef,controller=props.controller,topicStyle=(props.dir,controller.run("getTopicStyle",props)),config=model.config,topicContent=controller.run("renderTopicContent",__assign(__assign({},props),{topicStyle:topicStyle,dir:core_1.TopicDirection.MAIN})),partTopics=controller.run("getPartTopics",{layout:config.layoutDir,model:model,topicKey:topicKey}),rootTopic=React.createElement(Topic,{ref:saveRef(utils_1.topicRefKey(topicKey))},topicContent),children=controller.run("renderRootWidgetOtherChildren",props);switch(config.layoutDir){case core_1.DiagramLayoutType.LEFT_AND_RIGHT:return React.createElement(React.Fragment,null,this.renderPartTopics(partTopics.L,"L"),rootTopic,this.renderPartTopics(partTopics.R,"R"),children);case core_1.DiagramLayoutType.LEFT_TO_RIGHT:return React.createElement(React.Fragment,null,rootTopic,this.renderPartTopics(partTopics.R,"R"),children);case core_1.DiagramLayoutType.RIGHT_TO_LEFT:return React.createElement(React.Fragment,null,this.renderPartTopics(partTopics.L,"L"),rootTopic,children);case core_1.DiagramLayoutType.TOP_TO_BOTTOM:return React.createElement(React.Fragment,null,rootTopic,this.renderPartTopics(partTopics.B,"B"),children)}return null},RootWidget}(React.Component);exports.RootWidget=RootWidget},821:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0),core_1=__webpack_require__(51),TopicContextMenu=function(_super){function TopicContextMenu(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TopicContextMenu,_super),TopicContextMenu.prototype.render=function(){var controller=this.props.controller;return React.createElement(core_1.Menu,null,controller.run("customizeTopicContextMenu",this.props))},TopicContextMenu}(__webpack_require__(64).BaseWidget);exports.TopicContextMenu=TopicContextMenu},822:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,templateObject_3,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),classnames_1=__webpack_require__(4),core_1=__webpack_require__(31),utils_1=__webpack_require__(43),Icon=styled_components_1.default.div.withConfig({displayName:"Icon",componentId:"sc-yayglp"})(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"],["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(_a){var dir=_a.dir;return dir===core_1.TopicDirection.RIGHT?styled_components_1.css(templateObject_1||(templateObject_1=__makeTemplateObject(["\n        right: -25px;\n      "],["\n        right: -25px;\n      "]))):dir===core_1.TopicDirection.LEFT?styled_components_1.css(templateObject_2||(templateObject_2=__makeTemplateObject(["\n        left: -25px;\n      "],["\n        left: -25px;\n      "]))):void 0}),(function(props){return props.background}));exports.TopicCollapseIcon=function TopicCollapseIcon(props){var _a,model=props.model,topicKey=props.topicKey,topicStyle=props.topicStyle,dir=props.dir,saveRef=props.saveRef,onClickCollapse=props.onClickCollapse,topic=model.getTopic(topicKey);return topic.subKeys.size>0?React.createElement(Icon,{ref:saveRef(utils_1.collapseRefKey(topicKey)),onClick:onClickCollapse,background:topicStyle.background,dir:dir,className:classnames_1.default((_a={icon:!0,iconfont:!0},_a["bm-"+(topic.collapse?"plus":"minus")]=!0,_a))}):null}},823:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=this&&this.__spread||function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,templateObject_3,templateObject_4,templateObject_5,templateObject_6,templateObject_7,templateObject_8,templateObject_9,templateObject_10,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(51),select_1=__webpack_require__(1165),common_1=__webpack_require__(64),react_color_1=__webpack_require__(824),lodash_1=__webpack_require__(909),debug_1=__webpack_require__(28),operation_1=__webpack_require__(76),utils_1=__webpack_require__(43),log=debug_1.default("node:style-editor"),StyleEditorRoot=styled_components_1.default.div.withConfig({displayName:"StyleEditorRoot",componentId:"sc-lf9afa"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  z-index: 4;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  z-index: 4;\n"]))),Title=styled_components_1.default.div.withConfig({displayName:"Title",componentId:"sc-ei3ra2"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  height: 16px;\n"],["\n  height: 16px;\n"]))),CloseIcon=styled_components_1.default.div.withConfig({displayName:"CloseIcon",componentId:"sc-12mte36"})(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"],["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),PopRoot=styled_components_1.default.div.withConfig({displayName:"PopRoot",componentId:"sc-k4xur7"})(templateObject_4||(templateObject_4=__makeTemplateObject(["\n  padding: 10px;\n"],["\n  padding: 10px;\n"]))),ShowMenuIcon=styled_components_1.default.a.withConfig({displayName:"ShowMenuIcon",componentId:"sc-wgh8ra"})(templateObject_5||(templateObject_5=__makeTemplateObject(["\n  font-size: 20px !important;\n"],["\n  font-size: 20px !important;\n"]))),IconBg=styled_components_1.default.div.withConfig({displayName:"IconBg",componentId:"sc-v3lkeu"})(templateObject_6||(templateObject_6=__makeTemplateObject(["\n  padding: 5px;\n  cursor: pointer;\n"],["\n  padding: 5px;\n  cursor: pointer;\n"]))),WithBorder=styled_components_1.default.div.withConfig({displayName:"WithBorder",componentId:"sc-149gx6t"})(templateObject_7||(templateObject_7=__makeTemplateObject(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"],["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"]))),SettingTitle=styled_components_1.default.div.withConfig({displayName:"SettingTitle",componentId:"sc-674cvn"})(templateObject_8||(templateObject_8=__makeTemplateObject(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n"],["\n  margin-top: 10px;\n  margin-bottom: 5px;\n"]))),SettingItem=styled_components_1.default.span.withConfig({displayName:"SettingItem",componentId:"sc-kjkl5y"})(templateObject_9||(templateObject_9=__makeTemplateObject(["\n  margin: 0px 10px 0px 0px;\n"],["\n  margin: 0px 10px 0px 0px;\n"]))),ColorBar=styled_components_1.default.div.withConfig({displayName:"ColorBar",componentId:"sc-1pkgea9"})(templateObject_10||(templateObject_10=__makeTemplateObject(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"],["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(props){return props.color})),PxSelect=select_1.Select.ofType(),renderItem=function(unit){return function(width,_a){var handleClick=_a.handleClick;_a.modifiers,_a.query;return React.createElement(core_1.MenuItem,{text:""+width+unit,key:width,onClick:handleClick})}},StyleEditor=function(_super){function StyleEditor(props){var _this=_super.call(this,props)||this;return _this.setShowPanel=function(showPanel){return function(){_this.setState({showPanel:showPanel})}},_this.setStyle=function(obj){var style=_this.topic.style,styleObj=style?JSON.parse(style):{},newStyleObj=__assign(__assign({},styleObj),obj);if(!lodash_1.isEqual(styleObj,newStyleObj)){var newStyleStr=JSON.stringify(newStyleObj);_this.operation(operation_1.OpType.SET_STYLE,__assign(__assign({},_this.props),{style:newStyleStr}))}},_this.setLinkStyle=function(obj){var style=_this.topic.style,styleObj=style?JSON.parse(style):{},newStyleObj=__assign(__assign({},styleObj),{linkStyle:__assign(__assign({},styleObj.linkStyle),obj)});if(!lodash_1.isEqual(styleObj,newStyleObj)){var newStyleStr=JSON.stringify(newStyleObj);_this.operation(operation_1.OpType.SET_STYLE,__assign(__assign({},_this.props),{style:newStyleStr}))}},_this.handleBorderWidthChange=function(value){log("handleBorderWithChange:",value),_this.setStyle({borderWidth:value+"px"})},_this.handleBorderStyleChange=function(value){_this.setStyle({borderStyle:value})},_this.handleBorderRadiusChange=function(value){log("handleBorderRadiusChange:",value),_this.setStyle({borderRadius:value+"px"})},_this.handleLinkWidthChange=function(value){log("handleBorderRadiusChange:",value),_this.setLinkStyle({lineWidth:value+"px"})},_this.handleBorderColorChange=function(color){log(color),_this.setStyle({borderColor:color.hex})},_this.handleBackgroundColorChange=function(color){log(color),_this.setStyle({background:color.hex})},_this.handleLinkColorChange=function(color){log(color),_this.setLinkStyle({lineColor:color.hex})},_this.state={showPanel:!1},_this}return __extends(StyleEditor,_super),StyleEditor.prototype.render=function(){var props=this.props,controller=props.controller;if(!props.model.focusKey)return null;var topicStyle=controller.run("getTopicStyle",props),linkStyle=topicStyle.linkStyle;if(!this.state.showPanel)return React.createElement(StyleEditorRoot,null,React.createElement(IconBg,{onClick:this.setShowPanel(!0)},React.createElement(ShowMenuIcon,{className:utils_1.iconClassName(utils_1.IconName.SHOW_MENU)})));var borderWidthItems=__spread(Array(7).keys());return React.createElement(StyleEditorRoot,null,React.createElement(Title,null,React.createElement(CloseIcon,{className:utils_1.iconClassName(utils_1.IconName.CLOSE),onClick:this.setShowPanel(!1)})),React.createElement(PopRoot,null,React.createElement(SettingTitle,null,"Border"),React.createElement("div",null,React.createElement(SettingItem,null,React.createElement(PxSelect,{items:borderWidthItems,itemRenderer:renderItem("px"),filterable:!1,onItemSelect:this.handleBorderWidthChange},React.createElement(core_1.Button,{text:"width: "+(topicStyle.borderWidth?topicStyle.borderWidth:"0px")}))),React.createElement(SettingItem,null,React.createElement(PxSelect,{items:["none","solid","dotted","dashed","double"],itemRenderer:renderItem(""),filterable:!1,onItemSelect:this.handleBorderStyleChange},React.createElement(core_1.Button,{text:"style: "+(topicStyle.borderStyle?topicStyle.borderStyle:"none")}))),React.createElement(SettingItem,null,React.createElement(PxSelect,{items:[0,5,10,15,20,25,30,35],itemRenderer:renderItem("px"),filterable:!1,onItemSelect:this.handleBorderRadiusChange},React.createElement(core_1.Button,{text:"radius: "+topicStyle.borderRadius}))),React.createElement(SettingItem,null,React.createElement(core_1.Popover,null,React.createElement(WithBorder,null,React.createElement("div",{className:utils_1.iconClassName(utils_1.IconName.COLOR_PICKER)}),React.createElement(ColorBar,{color:topicStyle.borderColor})),React.createElement("div",null,React.createElement(react_color_1.SketchPicker,{color:topicStyle.borderColor,onChangeComplete:this.handleBorderColorChange}))))),React.createElement(SettingTitle,null,"Background"),React.createElement("div",null,React.createElement(SettingItem,null,React.createElement(core_1.Popover,null,React.createElement(WithBorder,null,React.createElement("div",{className:utils_1.iconClassName(utils_1.IconName.COLOR_PICKER)}),React.createElement(ColorBar,{color:topicStyle.background})),React.createElement("div",null,React.createElement(react_color_1.SketchPicker,{color:topicStyle.background,onChangeComplete:this.handleBackgroundColorChange}))))),React.createElement(SettingTitle,null,"Link"),React.createElement("div",null,React.createElement(SettingItem,null,React.createElement(PxSelect,{items:borderWidthItems,itemRenderer:renderItem("px"),filterable:!1,onItemSelect:this.handleLinkWidthChange},React.createElement(core_1.Button,{text:"width: "+(linkStyle?linkStyle.lineWidth:"0px")}))),React.createElement(SettingItem,null,React.createElement(core_1.Popover,null,React.createElement(WithBorder,null,React.createElement("div",{className:utils_1.iconClassName(utils_1.IconName.COLOR_PICKER)}),React.createElement(ColorBar,{color:topicStyle.background})),React.createElement("div",null,React.createElement(react_color_1.SketchPicker,{color:topicStyle.background,onChangeComplete:this.handleLinkColorChange})))))))},StyleEditor}(common_1.BaseWidget);exports.StyleEditor=StyleEditor},910:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(31),common_1=__webpack_require__(64),utils_1=__webpack_require__(43),utils_2=__webpack_require__(43),TopicLinksSvg=styled_components_1.default.svg.withConfig({displayName:"TopicLinksSvg",componentId:"sc-1fx818d"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),log=__webpack_require__(28).default("node:topic-sub-links"),TopicSubLinks=function(_super){function TopicSubLinks(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.state={curves:[]},_this}return __extends(TopicSubLinks,_super),TopicSubLinks.prototype.layout=function(){var p1,p2,p3,props=this.props,model=props.model,getRef=props.getRef,topicKey=props.topicKey,dir=props.dir,controller=props.controller,topic=model.getTopic(topicKey),content=getRef(utils_2.contentRefKey(topicKey)),svgRect=getRef(utils_2.linksSvgRefKey(topicKey)).getBoundingClientRect(),collapseRect=getRef(utils_2.collapseRefKey(topicKey)).getBoundingClientRect(),contentRect=content.getBoundingClientRect();dir===core_1.TopicDirection.RIGHT?(p1={x:0,y:utils_1.centerY(contentRect)-svgRect.top},p2={x:collapseRect.right-svgRect.left+10,y:p1.y}):dir===core_1.TopicDirection.LEFT&&(p1={x:svgRect.right,y:utils_1.centerY(contentRect)-svgRect.top},p2={x:collapseRect.left-svgRect.left-10,y:p1.y});var curves=[];topic.subKeys.forEach((function(key){var curve,linkStyle=controller.run("getLinkStyle",__assign(__assign({},props),{topicKey:key})),rect=getRef(utils_2.contentRefKey(key)).getBoundingClientRect();dir===core_1.TopicDirection.RIGHT&&(p3={x:rect.left-svgRect.left,y:utils_1.centerY(rect)-svgRect.top}),dir===core_1.TopicDirection.LEFT&&(p3={x:rect.right-svgRect.left,y:utils_1.centerY(rect)-svgRect.top});var lineType=linkStyle.lineType;if("curve"===lineType)curve="M "+p1.x+" "+p1.y+" L "+p2.x+" "+p2.y+" C "+p2.x+" "+utils_1.centerPointY(p2,p3)+" "+utils_1.centerPointX(p2,p3)+" "+p3.y+" "+p3.x+" "+p3.y;else if("round"===lineType){var vDir=p3.y>p1.y?1:-1,hDir=p3.x>p1.x?1:-1,radius=linkStyle.lineRadius;curve=p3.y===p1.y?"M "+p1.x+" "+p1.y+" H "+p3.x:"M "+p1.x+" "+p1.y+" H "+p2.x+" V "+(p3.y-vDir*radius)+" A "+radius+" "+radius+" 0 0 "+(vDir*hDir==1?0:1)+" "+(p2.x+radius*hDir)+" "+p3.y+" H "+p3.x}else"line"===lineType&&(curve="M "+p1.x+" "+p1.y+" H "+p2.x+" L "+p3.x+" "+p3.y);curves.push(React.createElement("path",{key:"link-"+key,d:curve,strokeWidth:linkStyle.lineWidth,stroke:linkStyle.lineColor,fill:"none"}))})),log("curves:",curves),this.setState({curves:curves})},TopicSubLinks.prototype.render=function(){var _a=this.props,topicKey=_a.topicKey,saveRef=_a.saveRef;return React.createElement(TopicLinksSvg,{ref:saveRef(utils_2.linksSvgRefKey(topicKey))},React.createElement("g",null,this.state.curves))},TopicSubLinks}(common_1.BaseWidget);exports.TopicSubLinks=TopicSubLinks},911:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),common_1=__webpack_require__(64),utils_1=__webpack_require__(43),debug_1=__webpack_require__(28),utils_2=__webpack_require__(43),RootLinksSvg=styled_components_1.default.svg.withConfig({displayName:"RootLinksSvg",componentId:"sc-1j5kekp"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),RootSubLinks=(debug_1.default("node:topic-sub-links"),function(_super){function RootSubLinks(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.state={curves:[]},_this}return __extends(RootSubLinks,_super),RootSubLinks.prototype.layout=function(){var p1,p2,props=this.props,model=props.model,getRef=props.getRef,topicKey=props.topicKey,controller=(props.dir,props.controller),topic=model.getTopic(topicKey),contentRect=getRef(utils_2.contentRefKey(topicKey)).getBoundingClientRect(),svgRect=getRef(utils_2.linksSvgRefKey(topicKey)).getBoundingClientRect();p1={x:utils_1.centerX(contentRect)-svgRect.left,y:utils_1.centerY(contentRect)-svgRect.top};var curves=[];topic.subKeys.forEach((function(key){var curve,style=controller.run("getTopicStyle",__assign(__assign({},props),{topicKey:key})),linkStyle=style.linkStyle,lineType=linkStyle.lineType,rect=getRef(utils_2.contentRefKey(key)).getBoundingClientRect();if(p2={x:(p2=rect.left>contentRect.right?{x:rect.left,y:utils_1.centerY(rect)}:{x:rect.right,y:utils_1.centerY(rect)}).x-svgRect.left,y:p2.y-svgRect.top},"curve"===lineType)curve="M "+p1.x+" "+p1.y+" C "+p1.x+" "+utils_1.centerPointY(p1,p2)+" "+utils_1.centerPointX(p1,p2)+" "+p2.y+" "+p2.x+" "+p2.y;else if("line"===lineType)curve="M "+p1.x+" "+p1.y+" L "+p2.x+" "+p2.y;else if("round"===lineType){var vDir=p2.y>p1.y?1:-1,hDir=p2.x>p1.x?1:-1,radius=linkStyle.lineRadius;if(null==radius)throw new Error("link line type is round, but lineRadius is not provided!");curve=p2.y===p1.y?"M "+p1.x+" "+p1.y+" H "+p2.x:"M "+p1.x+" "+p1.y+"  V "+(p2.y-vDir*radius)+" A "+radius+" "+radius+" 0 0 "+(vDir*hDir==1?0:1)+" "+(p1.x+radius*hDir)+" "+p2.y+" H "+p2.x}curves.push(React.createElement("path",{key:"link-"+key,d:curve,strokeWidth:style.linkStyle.lineWidth,stroke:style.linkStyle.lineColor,fill:"none"}))})),this.setState({curves:curves})},RootSubLinks.prototype.render=function(){var _a=this.props,topicKey=_a.topicKey,saveRef=_a.saveRef;return React.createElement(RootLinksSvg,{ref:saveRef(utils_2.linksSvgRefKey(topicKey))},React.createElement("g",null,this.state.curves))},RootSubLinks}(common_1.BaseWidget));exports.RootSubLinks=RootSubLinks},912:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),common_1=__webpack_require__(64),utils_1=__webpack_require__(43),core_1=__webpack_require__(31),FocusHighlightSvg=styled_components_1.default.svg.withConfig({displayName:"FocusHighlightSvg",componentId:"sc-gqm9s8"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),TopicHighlight=function(_super){function TopicHighlight(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.state={content:null},_this}return __extends(TopicHighlight,_super),TopicHighlight.prototype.layout=function(){var _a=this.props,getRef=_a.getRef,model=_a.model,focusKey=model.focusKey,focusMode=model.focusMode;if(focusKey&&focusMode!==core_1.FocusMode.EDITING_CONTENT){var contentRect=getRef(utils_1.contentRefKey(focusKey)).getBoundingClientRect(),svgRect=getRef("svg-highlight").getBoundingClientRect(),x=contentRect.left-svgRect.left-3,y=contentRect.top-svgRect.top-3,width=contentRect.width+6,height=contentRect.height+6;this.setState({content:React.createElement("rect",{x:x,y:y,width:width,height:height,fill:"none",stroke:model.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})},TopicHighlight.prototype.render=function(){var saveRef=this.props.saveRef;return React.createElement(FocusHighlightSvg,{ref:saveRef("svg-highlight")},this.state.content)},TopicHighlight}(common_1.BaseWidget);exports.TopicHighlight=TopicHighlight},913:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),common_1=__webpack_require__(64),utils_1=__webpack_require__(43),NodeLayer=styled_components_1.default.div.withConfig({displayName:"NodeLayer",componentId:"sc-10k9w9g"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"],["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),DIV=styled_components_1.default.div.withConfig({displayName:"DIV",componentId:"sc-1foqqg0"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"],["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(props){return props.theme.background})),MindDragScrollWidget=function(_super){function MindDragScrollWidget(props){var _this=_super.call(this,props)||this;return _this.onClick=function(e){},_this}return __extends(MindDragScrollWidget,_super),MindDragScrollWidget.prototype.componentDidMount=function(){var _a=this.props,getRef=_a.getRef,model=_a.model,rootTopic=getRef(utils_1.topicRefKey(model.editorRootTopicKey)),nodeLayer=getRef("node-layer"),rootTopicRect=rootTopic.getBoundingClientRect(),nodeLayerRect=nodeLayer.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,rootTopicRect.top-nodeLayerRect.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+rootTopicRect.height)},Object.defineProperty(MindDragScrollWidget.prototype,"dragScrollWidget",{get:function(){return this.props.getRef("DragScrollWidget")},enumerable:!0,configurable:!0}),MindDragScrollWidget.prototype.render=function(){var _this=this,_a=this.props,saveRef=_a.saveRef,model=_a.model,controller=_a.controller,nodeKey=model.editorRootTopicKey;return React.createElement(DIV,null,React.createElement(common_1.DragScrollWidget,__assign({},this.state,{ref:saveRef("DragScrollWidget")}),(function(setViewBoxScroll,setViewBoxScrollDelta){var rootWidgetProps=__assign(__assign({},_this.props),{topicKey:nodeKey,setViewBoxScroll:setViewBoxScroll,setViewBoxScrollDelta:setViewBoxScrollDelta});return React.createElement(NodeLayer,{ref:saveRef("node-layer")},controller.run("renderRootWidget",rootWidgetProps))})))},MindDragScrollWidget}(React.Component);exports.MindDragScrollWidget=MindDragScrollWidget},914:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(51),common_1=__webpack_require__(64),Modals=(styled_components_1.default.div.withConfig({displayName:"DescWrapper",componentId:"sc-1gzzjwe"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  border: 1px solid #d9d9d9;\n  height: calc(100% - 50px);\n  padding: 0 1rem;\n  overflow: auto;\n  margin: 0.5rem 0.5rem 0 0.5rem;\n"],["\n  border: 1px solid #d9d9d9;\n  height: calc(100% - 50px);\n  padding: 0 1rem;\n  overflow: auto;\n  margin: 0.5rem 0.5rem 0 0.5rem;\n"]))),function(_super){function Modals(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.handleClose=function(){var handleActiveModalClose=_this.props.controller.run("handleActiveModalClose",_this.props);handleActiveModalClose&&handleActiveModalClose()},_this}return __extends(Modals,_super),Modals.prototype.render=function(){var controller=this.props.controller,activeModal=(controller.run("handleActiveModalClose",this.props),controller.run("renderModal",this.props)),activeModalProps=controller.run("getActiveModalProps",this.props);return React.createElement(core_1.Dialog,{onClose:this.handleClose,isOpen:null!==activeModal,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:activeModalProps&&activeModalProps.title,style:activeModalProps&&activeModalProps.style},React.createElement("div",{className:core_1.Classes.DIALOG_BODY,style:{minHeight:0}},activeModal))},Modals}(common_1.BaseWidget));exports.Modals=Modals},915:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),utils_1=__webpack_require__(43),operation_1=__webpack_require__(76),core_1=__webpack_require__(31),DescIcon=__webpack_require__(14).default.div.withConfig({displayName:"DescIcon",componentId:"sc-1di7d0s"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  &:hover {\n  }\n"],["\n  &:hover {\n  }\n"])));exports.TopicDescIcon=function TopicDescIcon(props){var controller=props.controller,model=props.model,topicKey=props.topicKey;return model.getTopic(topicKey).getBlock(core_1.BlockType.DESC).block&&React.createElement(DescIcon,{onClick:function(e){e.stopPropagation(),controller.run("operation",__assign(__assign({},props),{opType:operation_1.OpType.START_EDITING_DESC}))},className:utils_1.iconClassName(utils_1.IconName.NOTES)})}},916:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),common_1=__webpack_require__(64),operation_1=__webpack_require__(76),debug_1=__webpack_require__(28),simple_text_editor_1=__webpack_require__(441),NodeContent=(debug_1.default("node:topic-content-editor"),styled_components_1.default.div.withConfig({displayName:"NodeContent",componentId:"sc-zxq461"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  padding: 6px;\n  background-color: ",";\n  color: black;\n  cursor: ",";\n"],["\n  padding: 6px;\n  background-color: ",";\n  color: black;\n  cursor: ",";\n"])),(function(props){return props.readOnly?null:"white"}),(function(props){return props.readOnly?"pointer":"text"}))),SimpleTopicContentEditor=function(_super){function SimpleTopicContentEditor(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.onMouseDown=function(e){e.stopPropagation()},_this.onMouseMove=function(e){e.stopPropagation()},_this.onChange=function(value){_this.operation(operation_1.OpType.SET_TOPIC_CONTENT,__assign(__assign({},_this.props),{content:value}))},_this}return __extends(SimpleTopicContentEditor,_super),SimpleTopicContentEditor.prototype.render=function(){var _a=this.props,model=_a.model,topicKey=_a.topicKey,saveRef=_a.saveRef,content=_a.block.data,readOnly=!(topicKey===model.editingContentKey),key="editor-"+topicKey;return React.createElement(NodeContent,{key:key,readOnly:readOnly,ref:saveRef(key),onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove},React.createElement(simple_text_editor_1.SimpleTextEditor,{editorValue:content,readOnly:readOnly,onChange:this.onChange}))},SimpleTopicContentEditor}(common_1.BaseWidget);exports.SimpleTopicContentEditor=SimpleTopicContentEditor},917:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,styled_components_1=__webpack_require__(14);exports.ModalBody=styled_components_1.default.div.withConfig({displayName:"ModalBody",componentId:"sc-ix5l9"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  height: 100%;\n  flex: 1;\n  display: flex;\n  overflow: auto;\n  background: white;\n"],["\n  height: 100%;\n  flex: 1;\n  display: flex;\n  overflow: auto;\n  background: white;\n"]))),exports.ModalDescEditor=styled_components_1.default.div.withConfig({displayName:"ModalDescEditor",componentId:"sc-3ssumd"})(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  padding: 6px;\n  width: 100%;\n"],["\n  padding: 6px;\n  width: 100%;\n"])))},918:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),core_1=__webpack_require__(31),common_1=__webpack_require__(64),operation_1=__webpack_require__(76),debug_1=__webpack_require__(28),simple_text_editor_1=__webpack_require__(441),NodeContent=(debug_1.default("node:topic-content-editor"),styled_components_1.default.div.withConfig({displayName:"NodeContent",componentId:"sc-c4w50y"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  padding: 6px;\n  background-color: ",";\n  color: black;\n  cursor: ",";\n"],["\n  padding: 6px;\n  background-color: ",";\n  color: black;\n  cursor: ",";\n"])),(function(props){return props.readOnly?null:"white"}),(function(props){return props.readOnly?"pointer":"text"}))),SimpleTopicDescEditor=function(_super){function SimpleTopicDescEditor(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.onMouseDown=function(e){e.stopPropagation()},_this.onMouseMove=function(e){e.stopPropagation()},_this.onChange=function(value){_this.operation(operation_1.OpType.SET_TOPIC_DESC,__assign(__assign({},_this.props),{desc:value}))},_this}return __extends(SimpleTopicDescEditor,_super),SimpleTopicDescEditor.prototype.render=function(){var _a=this.props,model=_a.model,topicKey=_a.topicKey,saveRef=_a.saveRef,content=model.getTopic(topicKey).getBlock(core_1.BlockType.DESC).block.data,readOnly=!(topicKey===model.editingDescKey),key="desc-"+topicKey;return React.createElement(NodeContent,{key:key,readOnly:readOnly,ref:saveRef(key),onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove},React.createElement(simple_text_editor_1.SimpleTextEditor,{editorValue:content,readOnly:readOnly,onChange:this.onChange}))},SimpleTopicDescEditor}(common_1.BaseWidget);exports.SimpleTopicDescEditor=SimpleTopicDescEditor},919:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0),styled_components_1=__webpack_require__(14);exports.default=function Theme(_a){var theme=_a.theme,children=_a.children;return(React.createElement(styled_components_1.ThemeProvider,{theme:theme},React.createElement(React.Fragment,null,children)))}},920:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var operation_1=__webpack_require__(76),core_1=__webpack_require__(51),utils_1=__webpack_require__(43),React=__webpack_require__(0),items=[{icon:"edit",label:"edit",rootCanUse:!0,opType:operation_1.OpType.START_EDITING_CONTENT},{icon:"add-sibling",label:"add sibling",shortcut:"enter",opType:operation_1.OpType.ADD_SIBLING},{icon:"add-child",label:"add child",shortcut:"Tab",rootCanUse:!0,opType:operation_1.OpType.ADD_CHILD},{icon:"notes",label:"edit notes",shortcut:"Alt + D",opType:operation_1.OpType.START_EDITING_DESC},{icon:"delete-node",label:"delete node",shortcut:"Del",opType:operation_1.OpType.DELETE_TOPIC}];exports.customizeTopicContextMenu=function customizeTopicContextMenu(props){var topicKey=props.topicKey,model=props.model,controller=props.controller,isRoot=topicKey===model.editorRootTopicKey;function onClickItem(item){return function(e){item.opType&&controller.run("operation",__assign(__assign({},props),{opType:item.opType}))}}return items.map((function(item){return isRoot&&!item.rootCanUse?null:React.createElement(core_1.MenuItem,{key:item.label,icon:utils_1.Icon(item.icon),text:item.label,labelElement:React.createElement("kbd",null,item.shortcut),onClick:onClickItem(item)})}))}},921:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0),core_1=__webpack_require__(31),topic_widget_1=__webpack_require__(428),utils_1=__webpack_require__(43);exports.LayoutPlugin=function LayoutPlugin(){return{getPartTopics:function(_a){var layout=_a.layout,model=_a.model,topicKey=_a.topicKey,topic=model.getTopic(topicKey),subTopicCount=topic.subKeys.size,topics=topic.subKeys.toArray();switch(layout){case core_1.DiagramLayoutType.LEFT_TO_RIGHT:return{R:topics};case core_1.DiagramLayoutType.RIGHT_TO_LEFT:return{L:topics};case core_1.DiagramLayoutType.LEFT_AND_RIGHT:return{L:topics.slice(Math.ceil(subTopicCount/2),subTopicCount),R:topics.slice(0,Math.ceil(subTopicCount/2))};case core_1.DiagramLayoutType.TOP_TO_BOTTOM:return{B:topics}}},createSubTopics:function(_a){var props=_a.props,topics=_a.topics,model=props.model,topicKey=props.topicKey,topic=model.getTopic(topicKey);if(0===topics.size||topic.collapse)return null;var subTopics=[];return topics.forEach((function(tKey){var subTopicProps=__assign(__assign({},props),{topicKey:tKey});subTopics.push(React.createElement(topic_widget_1.TopicWidget,__assign({key:tKey},subTopicProps)))})),{subTopics:subTopics}},layout:function(props){var getRef=props.getRef,topicKey=props.topicKey,links=getRef(utils_1.linksRefKey(topicKey)),highlight=getRef("focus-highlight"),dropEffect=getRef("drop-effect");links&&links.layout(),highlight&&highlight.layout(),dropEffect&&dropEffect.layout()},setLayoutDir:function(props){var layoutDir=props.layoutDir,model=props.model;props.controller.change(core_1.ModelModifier.setLayoutDir({model:model,layoutDir:layoutDir}))}}}},922:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=__webpack_require__(31),log=__webpack_require__(28).default("plugin:StylePlugin");exports.StylePlugin=function StylePlugin(){var colorMap=new Map,colorIndex=0;return{getTopicStyle:function(props){log("getTopicStyle");var themeStyle,topicKey=props.topicKey,model=props.model,controller=props.controller,visualLevel=model.getTopicVisualLevel(topicKey),theme=model.config.theme;if(themeStyle=visualLevel===core_1.TopicVisualLevel.ROOT?theme.rootTopic:visualLevel===core_1.TopicVisualLevel.PRIMARY?theme.primaryTopic:theme.normalTopic,theme.randomColor){var randomColor=controller.run("getRandomColor",props);themeStyle=__assign(__assign({},themeStyle),{background:randomColor,borderColor:randomColor,linkStyle:__assign(__assign({},themeStyle.linkStyle),{lineColor:randomColor})})}var topic=model.getTopic(topicKey);if(!topic.style)return themeStyle;var customStyle=JSON.parse(topic.style);return __assign(__assign(__assign({},themeStyle),customStyle),{linkStyle:__assign(__assign({},themeStyle.linkStyle),customStyle.linkStyle)})},getLinkStyle:function(props){var linkStyle,topicKey=props.topicKey,model=props.model,controller=props.controller,visualLevel=model.getTopicVisualLevel(topicKey),theme=model.config.theme;linkStyle=visualLevel===core_1.TopicVisualLevel.ROOT?theme.rootTopic.linkStyle:visualLevel===core_1.TopicVisualLevel.PRIMARY?theme.primaryTopic.linkStyle:theme.normalTopic.linkStyle;var topic=model.getTopic(topicKey);if(theme.randomColor){var randomColor=controller.run("getRandomColor",__assign(__assign({},props),{topicKey:topic.parentKey!==model.editorRootTopicKey?topic.parentKey:topicKey}));linkStyle=__assign(__assign({},linkStyle),{lineColor:randomColor})}if(!topic.style)return linkStyle;var customStyle=JSON.parse(topic.style);return __assign(__assign({},linkStyle),customStyle.linkStyle)},getTopicThemeStyle:function(props){var topicKey=props.topicKey,model=props.model,visualLevel=model.getTopicVisualLevel(topicKey),theme=model.config.theme;return visualLevel===core_1.TopicVisualLevel.ROOT?theme.rootTopic:visualLevel===core_1.TopicVisualLevel.PRIMARY?theme.primaryTopic:theme.normalTopic},getRandomColor:function(props){var topicKey=props.topicKey;if(colorMap.has(topicKey))return colorMap.get(topicKey);var colors=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#F92A82","#83BCFF"],color=colors[++colorIndex%colors.length];return colorMap.set(topicKey,color),color}}}},923:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var operation_1=__webpack_require__(76),core_1=__webpack_require__(31),log=__webpack_require__(28).default("plugin:event");exports.EventPlugin=function EventPlugin(){return{handleTopicClick:function(props){log("handleTopicClick");var controller=props.controller,model=props.model,topicKey=props.topicKey;model.focusKey===topicKey&&model.focusMode===core_1.FocusMode.EDITING_CONTENT||controller.run("operation",__assign(__assign({},props),{opType:operation_1.OpType.FOCUS_TOPIC,focusMode:core_1.FocusMode.NORMAL}))},handleTopicDoubleClick:function(props){props.controller.run("operation",__assign(__assign({},props),{opType:operation_1.OpType.FOCUS_TOPIC,focusMode:core_1.FocusMode.EDITING_CONTENT}))},handleTopicContextMenu:function(props){props.controller.run("operation",__assign(__assign({},props),{opType:operation_1.OpType.FOCUS_TOPIC,focusMode:core_1.FocusMode.SHOW_POPUP}))},handleActiveModalClose:function(props){var controller=props.controller,activeModalProps=controller.run("getActiveModalProps",props);return null==activeModalProps?null:"edit-desc"===activeModalProps.name?function(){controller.run("operation",__assign(__assign({},props),{focusMode:core_1.FocusMode.NORMAL,opType:operation_1.OpType.FOCUS_TOPIC}))}:void 0}}}},924:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var operation_1=__webpack_require__(76);function op(opType,props){var topicKey=props.topicKey,model=props.model,controller=props.controller;void 0===topicKey&&(props=__assign(__assign({},props),{topicKey:model.focusKey})),controller.run("operation",__assign(__assign({},props),{opType:opType}))}exports.HotKeyName={ADD_CHILD:"ADD_CHILD",ADD_SIBLING:"ADD_SIBLING",DELETE_TOPIC:"DELETE_TOPIC",EDIT_NOTES:"EDIT_NOTES"},exports.HotKeyPlugin=function HotKeyPlugin(){return{customizeHotKeys:function(props){return new Map([[exports.HotKeyName.ADD_CHILD,{label:"add child",combo:"tab",onKeyDown:function(e){op(operation_1.OpType.ADD_CHILD,props)}}],[exports.HotKeyName.ADD_SIBLING,{label:"add sibling",combo:"enter",onKeyDown:function(e){op(operation_1.OpType.ADD_SIBLING,props)}}],[exports.HotKeyName.DELETE_TOPIC,{label:"delete topic",combo:"del",onKeyDown:function(e){op(operation_1.OpType.DELETE_TOPIC,props)}}],[exports.HotKeyName.EDIT_NOTES,{label:"edit notes",combo:"alt + d",onKeyDown:function(e){op(operation_1.OpType.START_EDITING_DESC,props)}}]])}}}},925:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),operation_1=__webpack_require__(76),core_1=__webpack_require__(31),debug_1=__webpack_require__(28),topic_drop_effect_1=__webpack_require__(926),utils_1=__webpack_require__(43),log=debug_1.default("plugin:drag-and-drop"),DropArea=styled_components_1.default.div.withConfig({displayName:"DropArea",componentId:"sc-1cii8a2"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"],["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(props){return props.height+"px"}));styled_components_1.default.svg.withConfig({displayName:"DropEffects",componentId:"sc-15j923v"})(templateObject_2||(templateObject_2=__makeTemplateObject([""],[""])));exports.DragAndDrop=function DragAndDrop(){var dragTargetKey=null,dragTargetDir=null;return{renderTopicDropArea:function(props){var topicKey=props.topicKey,dropDir=props.dropDir,saveRef=props.saveRef,controller=props.controller,model=props.model,eventHandlers={onDragEnter:function(ev){log("onDragEnter",topicKey,dropDir),controller.run("handleTopicDragEnter",__assign(__assign({},props),{ev:ev,dropDir:dropDir}))},onDragLeave:function(ev){log("onDragLeave",topicKey,dropDir),controller.run("handleTopicDragLeave",__assign(__assign({},props),{ev:ev,dropDir:dropDir}))},onDragOver:function(ev){ev.preventDefault()},onDrop:function(ev){log("onDrop",topicKey,dropDir),controller.run("handleTopicDrop",__assign(__assign({},props),{ev:ev,dropDir:dropDir}))}};return React.createElement(DropArea,__assign({height:model.config.theme.marginV/2,ref:saveRef("dropArea-"+dropDir+"-"+topicKey)},eventHandlers))},renderDragAndDropEffect:function(props){log("renderDragAndDropEffect");var saveRef=props.saveRef;return React.createElement(topic_drop_effect_1.TopicDropEffect,__assign({ref:saveRef("drop-effect")},props))},getDragTargetProps:function(props){return{key:dragTargetKey,dropDir:dragTargetDir}},handleTopicDragStart:function(props){var controller=props.controller;props.ev.stopPropagation(),controller.run("operation",__assign(__assign({},props),{opType:operation_1.OpType.FOCUS_TOPIC,focusMode:core_1.FocusMode.DRAGGING}))},canDrop:function(props){var srcKey=props.srcKey,dstKey=props.dstKey,model=props.model,dropDir=props.dropDir;return srcKey!==model.editorRootTopicKey&&srcKey!==dstKey&&core_1.getRelationship(model,srcKey,dstKey)!==core_1.TopicRelationship.ANCESTOR&&((dstKey!==model.editorRootTopicKey||"in"===dropDir)&&(model.getTopic(srcKey).parentKey!==dstKey||"in"!==dropDir))},handleTopicDragEnter:function(props){var dropDir=props.dropDir,topicKey=props.topicKey,controller=props.controller,model=props.model;props.ev;log("handleTopicDragEnter:",topicKey,dropDir),controller.run("canDrop",__assign(__assign({},props),{srcKey:model.focusKey,dstKey:topicKey}))&&(dragTargetKey=topicKey,dragTargetDir=dropDir,controller.change(model))},handleTopicDragLeave:function(props){var controller=props.controller,model=props.model,topicKey=props.topicKey,dropDir=props.dropDir,getRef=props.getRef,relatedTarget=props.ev.nativeEvent.relatedTarget;log("handleTopicDragLeave:",topicKey,dropDir);var content=getRef(utils_1.contentRefKey(topicKey));content==relatedTarget||content.contains(relatedTarget)||(dragTargetKey=null,dragTargetDir=null,controller.change(model))},handleTopicDrop:function(props){log("handleTopicDrop");var controller=props.controller,topicKey=props.topicKey,model=props.model;props=__assign(__assign({},props),{srcKey:model.focusKey,dstKey:topicKey}),dragTargetKey=null,dragTargetDir=null,controller.run("canDrop",props)&&controller.run("operation",__assign(__assign({},props),{opType:operation_1.OpType.DRAG_AND_DROP}))}}}},926:function(module,exports,__webpack_require__){"use strict";var extendStatics,__makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,React=__webpack_require__(0),styled_components_1=__webpack_require__(14),common_1=__webpack_require__(64),utils_1=__webpack_require__(43),log=__webpack_require__(28).default("node:topic-drop-effect"),DropEffectSvg=styled_components_1.default.svg.withConfig({displayName:"DropEffectSvg",componentId:"sc-1ptthlf"})(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),TopicDropEffect=function(_super){function TopicDropEffect(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.state={content:null},_this}return __extends(TopicDropEffect,_super),TopicDropEffect.prototype.layout=function(){var props=this.props,_a=this.props,getRef=_a.getRef,model=_a.model,targetProps=_a.controller.run("getDragTargetProps",props),key=targetProps.key,dropDir=targetProps.dropDir;if(log("layout",dropDir),null!==key){var contentRect=getRef("in"===dropDir?utils_1.contentRefKey(key):"dropArea-"+dropDir+"-"+key).getBoundingClientRect(),svgRect=getRef("svg-drop-effect").getBoundingClientRect(),x=contentRect.left-svgRect.left-3,y=contentRect.top-svgRect.top-3,width=contentRect.width+6,height=contentRect.height+6;this.setState({content:React.createElement("g",null,React.createElement("rect",{x:x,y:y,width:width,height:height,fill:"none",stroke:model.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})},TopicDropEffect.prototype.render=function(){var saveRef=this.props.saveRef;return React.createElement(DropEffectSvg,{ref:saveRef("svg-drop-effect")},this.state.content)},TopicDropEffect}(common_1.BaseWidget);exports.TopicDropEffect=TopicDropEffect},927:function(module,exports,__webpack_require__){var content=__webpack_require__(928);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0,transform:void 0,insertInto:void 0};__webpack_require__(284)(content,options);content.locals&&(module.exports=content.locals)},928:function(module,exports,__webpack_require__){(exports=module.exports=__webpack_require__(283)(!1)).push([module.i,"@import url(//at.alicdn.com/t/font_1280682_zy0qrgbgwlf.css);",""]),exports.push([module.i,".iconfont {\n  vertical-align: middle;\n}\n\n.fXedfB {\n  background: transparent !important;\n}\n",""])},932:function(module,exports,__webpack_require__){var content=__webpack_require__(933);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0,transform:void 0,insertInto:void 0};__webpack_require__(284)(content,options);content.locals&&(module.exports=content.locals)},933:function(module,exports,__webpack_require__){(module.exports=__webpack_require__(283)(!1)).push([module.i,".app {\n  width: calc(100vw - 10px);\n  height: calc(100vh - 20px);\n}\n",""])},934:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="### Add topic context menus to default 📧context menus by writing a plugin.\n\nThe following example demonstrates adding a menu item. Clicking on the menu pops up the key and style of the current topic.\n\n```jsx\nfunction onClickMyMenu(props) {\n  return function() {\n    const { topicKey, controller, model } = props;\n    alert(`this topic key is ${topicKey}`);\n    const topicStyle = controller.run('getTopicStyle', props);\n    alert(`this topic style is ${JSON.stringify(topicStyle)}`);\n  };\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys(props, next) {\n      const hotKeysMap = next();\n      hotKeysMap.set('MY_CUSTOM', {\n        label: 'MY_CUSTOM',\n        combo: 'shift + a',\n        onKeyDown: e => {\n          onClickMyMenu(props)();\n        }\n      });\n      return hotKeysMap;\n    }\n  };\n}\n\nfunction AddTopicContextMenuPlugin() {\n  return {\n    customizeTopicContextMenu(props, next) {\n      return (\n        <>\n          {next()}\n          <MenuDivider />\n          <MenuItem\n            icon=\"group-objects\"\n            label=\"Shift + A\"\n            text=\"my customize menu\"\n            onClick={onClickMyMenu(props)}\n          />\n        </>\n      );\n    }\n  };\n}\nconst plugins = [AddTopicContextMenuPlugin(), HotKeyPlugin()];\nexport class AddTopicContextMenuDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n}\n```"},935:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="通过编写插件在系统默认的📧context menu 基础上增加内容\n\n下面的例子演示增加一个menu项, 点击这个menu 弹出提示当前topic 的key 和 style\n\n```jsx\nfunction onClickMyMenu(props) {\n  return function() {\n    const { topicKey, controller, model } = props;\n    alert(`this topic key is ${topicKey}`);\n    const topicStyle = controller.run('getTopicStyle', props);\n    alert(`this topic style is ${JSON.stringify(topicStyle)}`);\n  };\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys(props, next) {\n      const hotKeysMap = next();\n      hotKeysMap.set('MY_CUSTOM', {\n        label: 'MY_CUSTOM',\n        combo: 'shift + a',\n        onKeyDown: e => {\n          onClickMyMenu(props)();\n        }\n      });\n      return hotKeysMap;\n    }\n  };\n}\n\nfunction AddTopicContextMenuPlugin() {\n  return {\n    customizeTopicContextMenu(props, next) {\n      return (\n        <>\n          {next()}\n          <MenuDivider />\n          <MenuItem\n            icon=\"group-objects\"\n            label=\"Shift + A\"\n            text=\"my customize menu\"\n            onClick={onClickMyMenu(props)}\n          />\n        </>\n      );\n    }\n  };\n}\nconst plugins = [AddTopicContextMenuPlugin(), HotKeyPlugin()];\nexport class AddTopicContextMenuDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n}\n```"},936:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='通过编写插件改变系统默认的 📧context menu：删除edit menu 项，在第二个位置增加自定义项 \n\n```jsx\nfunction ChangeDefaultTopicContextMenuPlugin() {\n  return {\n    customizeTopicContextMenu(props, next) {\n      let defaultMenus = next();\n      defaultMenus.splice(0, 1);\n      defaultMenus.splice(\n        1,\n        0,\n        <MenuItem\n          icon="group-objects"\n          label="Shift + A"\n          text="my customize menu"\n          onClick={onClickMyMenu(props)}\n        />\n      );\n      return <>{defaultMenus}</>;\n    }\n  };\n}\n\nconst changeDefaultContextMenuPlugins = [\n  ChangeDefaultTopicContextMenuPlugin(),\n  HotKeyPlugin()\n];\nexport class ChangeDefaultTopicContextMenuDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={changeDefaultContextMenuPlugins}\n      />\n    );\n  }\n}\n```'},937:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='### change default topic context menu\n\nChange the topic\'s default context menu by writing a plugin:\n\nDelete the edit menu item and add a custom item in the second position.\n\n```jsx\nfunction ChangeDefaultTopicContextMenuPlugin() {\n  return {\n    customizeTopicContextMenu(props, next) {\n      let defaultMenus = next();\n      defaultMenus.splice(0, 1);\n      defaultMenus.splice(\n        1,\n        0,\n        <MenuItem\n          icon="group-objects"\n          label="Shift + A"\n          text="my customize menu"\n          onClick={onClickMyMenu(props)}\n        />\n      );\n      return <>{defaultMenus}</>;\n    }\n  };\n}\n\nconst changeDefaultContextMenuPlugins = [\n  ChangeDefaultTopicContextMenuPlugin(),\n  HotKeyPlugin()\n];\nexport class ChangeDefaultTopicContextMenuDemo extends BaseDemo {\n  renderDiagram() {\n    return (\n      <Diagram\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={changeDefaultContextMenuPlugins}\n      />\n    );\n  }\n}\n```'},938:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(39),__webpack_require__(46),__webpack_require__(47),__webpack_require__(42),__webpack_require__(111),__webpack_require__(273),__webpack_require__(203),__webpack_require__(10),__webpack_require__(204),__webpack_require__(175),__webpack_require__(274),__webpack_require__(33),__webpack_require__(48),__webpack_require__(49);var react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(0),_storybook_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(80),_common_base_demo__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(134),_blink_mind_renderer_react__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(79),_blink_mind_plugin_json_serializer__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(486),_blink_mind_plugin_rich_text_editor__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(299),_blink_mind_plugin_rich_text_editor__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_blink_mind_plugin_rich_text_editor__WEBPACK_IMPORTED_MODULE_19__),styled_components__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(14),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(162),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(161),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(94),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(95),_utils__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(298),debug__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(28),debug__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(debug__WEBPACK_IMPORTED_MODULE_26__),_json_serializer_en_md__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(494),_json_serializer_zh_md__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(495);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)(descriptor=props[i]).enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _templateObject5(){var data=_taggedTemplateLiteral(["\n  width: calc(100% - 18px);\n  height: calc(100% - 36px);\n"]);return _templateObject5=function(){return data},data}function _templateObject4(){var data=_taggedTemplateLiteral(["\n  width: 100%;\n  height: 100%;\n"]);return _templateObject4=function(){return data},data}function _templateObject3(){var data=_taggedTemplateLiteral(["\n  width: 26px;\n  height: 26px;\n  font-size: 26px !important;\n  &:hover {\n    color: #106ba3;\n  }\n"]);return _templateObject3=function(){return data},data}function _templateObject2(){var data=_taggedTemplateLiteral(["\n  padding: 5px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n  display: inline-block;\n"]);return _templateObject2=function(){return data},data}function _templateObject(){var data=_taggedTemplateLiteral(["\n  width: calc(100% - 18px);\n  height: 36px;\n  background: white;\n"]);return _templateObject=function(){return data},data}function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}var log=debug__WEBPACK_IMPORTED_MODULE_26___default()("story:json-serializer"),ToolBar=styled_components__WEBPACK_IMPORTED_MODULE_20__.default.div(_templateObject()),ToolBarItem=styled_components__WEBPACK_IMPORTED_MODULE_20__.default.div(_templateObject2()),Icon=styled_components__WEBPACK_IMPORTED_MODULE_20__.default.div(_templateObject3()),Container=styled_components__WEBPACK_IMPORTED_MODULE_20__.default.div(_templateObject4()),DiagramContainer=styled_components__WEBPACK_IMPORTED_MODULE_20__.default.div(_templateObject5()),plugins=[_blink_mind_plugin_rich_text_editor__WEBPACK_IMPORTED_MODULE_19___default()(),Object(_blink_mind_plugin_json_serializer__WEBPACK_IMPORTED_MODULE_18__.JsonSerializerPlugin)()],_ref=react__WEBPACK_IMPORTED_MODULE_14__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_21__.a,null),JsonSerializerDemo=function(_BaseDemo){function JsonSerializerDemo(_props){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,JsonSerializerDemo),_this=function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}(this,_getPrototypeOf(JsonSerializerDemo).call(this,_props)),_defineProperty(_assertThisInitialized(_this),"onClickOpenFile",(function(){var input=document.createElement("input"),controller=_this.diagram.getDiagramProps().controller;input.type="file",input.accept=".json",log("add onchange"),input.addEventListener("change",(function(evt){var file=evt.target.files[0],fr=new FileReader;log("add fr onload"),fr.onload=function(evt){var txt=evt.target.result,obj=JSON.parse(txt);log("OpenFile:",obj);var model=controller.run("deserializeModel",{controller:controller,obj:obj});log("OpenFile:",model),_this.setState({model:model})},fr.readAsText(file)})),input.click()})),_defineProperty(_assertThisInitialized(_this),"onClickExport",(function(){_this.setState({showDialog:!0})})),_defineProperty(_assertThisInitialized(_this),"handleDialogClose",(function(){_this.setState({showDialog:!1})})),_defineProperty(_assertThisInitialized(_this),"onClickExportJson",(function(){var props=_this.diagram.getDiagramProps(),json=props.controller.run("serializeModel",props),jsonStr=JSON.stringify(json),url="data:text/plain,".concat(encodeURIComponent(jsonStr));Object(_utils__WEBPACK_IMPORTED_MODULE_25__.downloadFile)(url,"example.json"),_this.setState({showDialog:!1})})),_defineProperty(_assertThisInitialized(_this),"diagram",void 0),_defineProperty(_assertThisInitialized(_this),"diagramRef",(function(e){_this.diagram=e})),_this}return function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(JsonSerializerDemo,_BaseDemo),function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(JsonSerializerDemo,[{key:"renderToolbar",value:function renderToolbar(){return react__WEBPACK_IMPORTED_MODULE_14__.createElement(ToolBar,null,react__WEBPACK_IMPORTED_MODULE_14__.createElement(ToolBarItem,{onClick:this.onClickOpenFile},react__WEBPACK_IMPORTED_MODULE_14__.createElement(Icon,{className:Object(_blink_mind_renderer_react__WEBPACK_IMPORTED_MODULE_17__.iconClassName)("openfile")})),react__WEBPACK_IMPORTED_MODULE_14__.createElement(ToolBarItem,{onClick:this.onClickExport},react__WEBPACK_IMPORTED_MODULE_14__.createElement(Icon,{className:Object(_blink_mind_renderer_react__WEBPACK_IMPORTED_MODULE_17__.iconClassName)("export")})))}},{key:"renderDialog",value:function renderDialog(){return react__WEBPACK_IMPORTED_MODULE_14__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_22__.a,{onClose:this.handleDialogClose,isOpen:this.state.showDialog,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:"Please select export file format"},react__WEBPACK_IMPORTED_MODULE_14__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_23__.a,null,react__WEBPACK_IMPORTED_MODULE_14__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_24__.a,{text:"JSON(.json)",onClick:this.onClickExportJson}),_ref))}},{key:"renderDiagram",value:function renderDiagram(){return react__WEBPACK_IMPORTED_MODULE_14__.createElement(Container,null,this.renderToolbar(),this.renderDialog(),react__WEBPACK_IMPORTED_MODULE_14__.createElement(DiagramContainer,null,react__WEBPACK_IMPORTED_MODULE_14__.createElement(_blink_mind_renderer_react__WEBPACK_IMPORTED_MODULE_17__.Diagram,{model:this.state.model,onChange:this.onChange,plugins:plugins,ref:this.diagramRef})))}}]),JsonSerializerDemo}(_common_base_demo__WEBPACK_IMPORTED_MODULE_16__.BaseDemo),_ref2=react__WEBPACK_IMPORTED_MODULE_14__.createElement(JsonSerializerDemo,null);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_15__.storiesOf)("serializer-demo",module).add("json-serializer",(function(){return _ref2}),{notes:{markdown:{en:_json_serializer_en_md__WEBPACK_IMPORTED_MODULE_27__.a,zh:_json_serializer_zh_md__WEBPACK_IMPORTED_MODULE_28__.a}}})}.call(this,__webpack_require__(344)(module))},939:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=__webpack_require__(31),immutable_1=__webpack_require__(3),log=__webpack_require__(28).default("plugin:json-serializer");exports.JsonSerializerPlugin=function JsonSerializerPlugin(){return{serializeModel:function(props){var model=props.model,controller=props.controller;return{rootTopicKey:model.rootTopicKey,topics:model.topics.valueSeq().toArray().map((function(topic){return controller.run("serializeTopic",__assign(__assign({},props),{topic:topic}))})),config:controller.run("serializeConfig",__assign(__assign({},props),{config:model.config}))}},deserializeModel:function(props){var obj=props.obj,controller=props.controller,rootTopicKey=obj.rootTopicKey,topics=obj.topics,config=obj.config,model=new core_1.Model;return model=model.merge({rootTopicKey:rootTopicKey,editorRootTopicKey:rootTopicKey,config:controller.run("deserializeConfig",__assign(__assign({},props),{obj:config})),topics:controller.run("deserializeTopics",__assign(__assign({},props),{obj:topics}))}),log("deserializeModel",model),model},serializeConfig:function(props){return props.config.toJS()},deserializeConfig:function(props){var obj=props.obj;return new core_1.Config(obj)},serializeTopic:function(props){var topic=props.topic,controller=props.controller;return{key:topic.key,parentKey:topic.parentKey,subKeys:topic.subKeys.toArray(),collapse:topic.collapse,style:topic.style,blocks:topic.blocks.map((function(block){return controller.run("serializeBlock",__assign(__assign({},props),{block:block}))}))}},deserializeTopic:function(props){var obj=props.obj,controller=props.controller,key=obj.key,parentKey=obj.parentKey,subKeys=obj.subKeys,blocks=obj.blocks,style=obj.style,collapse=obj.collapse,topic=new core_1.Topic;return topic=topic.merge({key:key,parentKey:parentKey,subKeys:immutable_1.List(subKeys),style:style,collapse:collapse,blocks:controller.run("deserializeBlocks",__assign(__assign({},props),{obj:blocks}))})},deserializeTopics:function(props){var obj=props.obj,controller=props.controller,topics=immutable_1.Map();return topics=topics.withMutations((function(topics){obj.forEach((function(topic){return topics.set(topic.key,controller.run("deserializeTopic",__assign(__assign({},props),{obj:topic})))}))}))},serializeBlock:function(props){return props.block.toJS()},deserializeBlock:function(props){var obj=props.obj;return new core_1.Block(obj)},deserializeBlocks:function(props){var obj=props.obj,controller=props.controller,blocks=immutable_1.List();return blocks=blocks.withMutations((function(blocks){obj.forEach((function(block){return blocks.push(controller.run("deserializeBlock",__assign(__assign({},props),{obj:block})))}))}))}}}},940:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(0),topic_content_editor_1=__webpack_require__(941),topic_desc_editor_1=__webpack_require__(1150),markdown_serializer_1=__webpack_require__(1151),core_1=__webpack_require__(31);exports.default=function RichTextEditorPlugin(){return{renderTopicContentEditor:function(props){return React.createElement(topic_content_editor_1.TopicContentEditor,__assign({},props))},renderTopicDescEditor:function(props){return React.createElement(topic_desc_editor_1.TopicDescEditor,__assign({},props))},serializeBlock:function(props,next){var block=props.block;return block.type===core_1.BlockType.CONTENT||block.type===core_1.BlockType.DESC?{type:block.type,data:"string"==typeof block.data?block.data:markdown_serializer_1.default.serialize(block.data)}:next()},deserializeBlock:function(props,next){return next()}}}},941:function(module,exports,__webpack_require__){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var renderer_react_1=__webpack_require__(79),rich_text_editor_1=__webpack_require__(442),core_1=__webpack_require__(31),TopicContentEditor=function(_super){function TopicContentEditor(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getCustomizeProps=function(){var _a=_this.props,model=_a.model,topicKey=_a.topicKey;return{block:model.getTopic(topicKey).getBlock(core_1.BlockType.CONTENT).block,readOnly:model.editingContentKey!==topicKey,refKeyPrefix:"content-editor"}},_this.onChange=function(value){_this.operation(renderer_react_1.OpType.SET_TOPIC_CONTENT,__assign(__assign({},_this.props),{content:value}))},_this}return __extends(TopicContentEditor,_super),TopicContentEditor}(rich_text_editor_1.RichTextEditor);exports.TopicContentEditor=TopicContentEditor}},[[497,1,2]]]);
//# sourceMappingURL=main.8b94ffd76fde867c87c7.bundle.js.map